var di=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);import{c as hi,a as yi,g as gi}from"./hoisted.Cllz_4Nu.js";var nh=di((R,M)=>{const mi="https://oazeymuyzghnlmgbfvnc.supabase.co",wi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9hemV5bXV5emdobmxtZ2Jmdm5jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTk4NDI4ODksImV4cCI6MjAzNTQxODg4OX0.50Av9W7k6GG6dEiyf9TKupwtE92mBEoCBH7Ps8Sw4rU",bi=hi(mi,wi),vi=document.getElementById("resizer"),_i=document.getElementById("code-interpreter-container"),rt=document.getElementById("settingsModal"),Si=document.getElementById("saveSettingsBtn"),Ci=document.getElementById("closeSettingsBtn"),Ai=document.getElementById("storeId"),Ei=document.getElementById("publicKey"),Pi=document.getElementById("course-content"),Oi=document.getElementById("accountForm");document.getElementById("accountTab");let Sr=!1;vi.addEventListener("mousedown",t=>{Sr=!0,t.clientX});document.addEventListener("mousemove",t=>{if(!Sr)return;const e=document.body.offsetWidth-(t.clientX-document.body.offsetLeft),r=200,n=document.body.offsetWidth*.5;e>r&&e<n&&(_i.style.width=`${e}px`)});document.addEventListener("mouseup",()=>{Sr=!1});document.addEventListener("openSettingsModal",()=>{rt.style.display="block"});Ci.addEventListener("click",()=>{rt.style.display="none"});Si.addEventListener("click",()=>{const t=Ai.value,e=Ei.value,r=new FormData(Oi),n=Object.fromEntries(r.entries());document.dispatchEvent(new CustomEvent("saveSettings",{detail:{storeId:t,publicKey:e,accountData:n}})),rt.style.display="none"});window.addEventListener("click",t=>{t.target===rt&&(rt.style.display="none")});document.addEventListener("sectionChange",t=>{t.detail==="courses"&&$i()});function $i(){Pi.innerHTML=`
          <h1 class="text-3xl font-bold mb-6 text-gray-800 dark:text-gray-200">Welcome to Swell Surge</h1>
          <p class="text-lg text-gray-600 dark:text-gray-400 mb-8">Select a course or daily quest from the sidebar to start your learning journey!</p>
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
              <h2 class="text-xl font-semibold mb-4 text-indigo-600 dark:text-indigo-400">Featured Courses</h2>
              <ul class="space-y-2">
                <li class="text-gray-700 dark:text-gray-300">Introduction to Programming</li>
                <li class="text-gray-700 dark:text-gray-300">Web Development Fundamentals</li>
                <li class="text-gray-700 dark:text-gray-300">Data Science Essentials</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
              <h2 class="text-xl font-semibold mb-4 text-green-600 dark:text-green-400">Daily Quests</h2>
              <ul class="space-y-2">
                <li class="text-gray-700 dark:text-gray-300">Solve a Coding Challenge</li>
                <li class="text-gray-700 dark:text-gray-300">Learn a New Concept</li>
                <li class="text-gray-700 dark:text-gray-300">Practice Problem-Solving</li>
              </ul>
            </div>
            <div class="bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md">
              <h2 class="text-xl font-semibold mb-4 text-orange-600 dark:text-orange-400">Learning Resources</h2>
              <ul class="space-y-2">
                <li class="text-gray-700 dark:text-gray-300">Video Tutorials</li>
                <li class="text-gray-700 dark:text-gray-300">Interactive Exercises</li>
                <li class="text-gray-700 dark:text-gray-300">Community Forums</li>
              </ul>
            </div>
          </div>
        `}window.supabase=bi;window.openTab=function(t,e){var r,n,a;for(n=document.getElementsByClassName("tab-content"),r=0;r<n.length;r++)n[r].style.display="none";for(a=document.getElementsByClassName("tab"),r=0;r<a.length;r++)a[r].className=a[r].className.replace(" active","");document.getElementById(e).style.display="block",t.currentTarget.className+=" active"};const Ii=document.querySelectorAll("a[data-section]");Ii.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();const r=e.target.getAttribute("data-section");document.dispatchEvent(new CustomEvent("sectionChange",{detail:r}))})});const Ti=document.getElementById("settingsBtn");Ti.addEventListener("click",()=>{document.dispatchEvent(new CustomEvent("openSettingsModal"))});const Yr=document.getElementById("logoutBtn");Yr&&Yr.addEventListener("click",async()=>{try{const t=await fetch("/api/auth/signout",{method:"POST",headers:{"Content-Type":"application/json"}});t.ok?window.location.href="/":console.error("Error signing out:",await t.text())}catch(t){console.error("Error signing out:",t)}});var xi=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),n=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(n)!=="[object Symbol]")return!1;var a=42;e[r]=a;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var i=Object.getOwnPropertySymbols(e);if(i.length!==1||i[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var o=Object.getOwnPropertyDescriptor(e,r);if(o.value!==a||o.enumerable!==!0)return!1}return!0},Zr=typeof Symbol<"u"&&Symbol,Ri=xi,Mi=function(){return typeof Zr!="function"||typeof Symbol!="function"||typeof Zr("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:Ri()},Di="Function.prototype.bind called on incompatible ",Kt=Array.prototype.slice,ki=Object.prototype.toString,Bi="[object Function]",Fi=function(e){var r=this;if(typeof r!="function"||ki.call(r)!==Bi)throw new TypeError(Di+r);for(var n=Kt.call(arguments,1),a,i=function(){if(this instanceof a){var u=r.apply(this,n.concat(Kt.call(arguments)));return Object(u)===u?u:this}else return r.apply(e,n.concat(Kt.call(arguments)))},o=Math.max(0,r.length-n.length),s=[],c=0;c<o;c++)s.push("$"+c);if(a=Function("binder","return function ("+s.join(",")+"){ return binder.apply(this,arguments); }")(i),r.prototype){var l=function(){};l.prototype=r.prototype,a.prototype=new l,l.prototype=null}return a},Ni=Fi,Cr=Function.prototype.bind||Ni,ji=Cr,Li=ji.call(Function.call,Object.prototype.hasOwnProperty),w,Me=SyntaxError,ta=Function,xe=TypeError,Ht=function(t){try{return ta('"use strict"; return ('+t+").constructor;")()}catch{}},ue=Object.getOwnPropertyDescriptor;if(ue)try{ue({},"")}catch{ue=null}var Vt=function(){throw new xe},Ui=ue?function(){try{return arguments.callee,Vt}catch{try{return ue(arguments,"callee").get}catch{return Vt}}}():Vt,Se=Mi(),U=Object.getPrototypeOf||function(t){return t.__proto__},Ae={},zi=typeof Uint8Array>"u"?w:U(Uint8Array),pe={"%AggregateError%":typeof AggregateError>"u"?w:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?w:ArrayBuffer,"%ArrayIteratorPrototype%":Se?U([][Symbol.iterator]()):w,"%AsyncFromSyncIteratorPrototype%":w,"%AsyncFunction%":Ae,"%AsyncGenerator%":Ae,"%AsyncGeneratorFunction%":Ae,"%AsyncIteratorPrototype%":Ae,"%Atomics%":typeof Atomics>"u"?w:Atomics,"%BigInt%":typeof BigInt>"u"?w:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?w:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?w:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?w:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?w:Float32Array,"%Float64Array%":typeof Float64Array>"u"?w:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?w:FinalizationRegistry,"%Function%":ta,"%GeneratorFunction%":Ae,"%Int8Array%":typeof Int8Array>"u"?w:Int8Array,"%Int16Array%":typeof Int16Array>"u"?w:Int16Array,"%Int32Array%":typeof Int32Array>"u"?w:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Se?U(U([][Symbol.iterator]())):w,"%JSON%":typeof JSON=="object"?JSON:w,"%Map%":typeof Map>"u"?w:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Se?w:U(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?w:Promise,"%Proxy%":typeof Proxy>"u"?w:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?w:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?w:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Se?w:U(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?w:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Se?U(""[Symbol.iterator]()):w,"%Symbol%":Se?Symbol:w,"%SyntaxError%":Me,"%ThrowTypeError%":Ui,"%TypedArray%":zi,"%TypeError%":xe,"%Uint8Array%":typeof Uint8Array>"u"?w:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?w:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?w:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?w:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?w:WeakMap,"%WeakRef%":typeof WeakRef>"u"?w:WeakRef,"%WeakSet%":typeof WeakSet>"u"?w:WeakSet};try{null.error}catch(t){var qi=U(U(t));pe["%Error.prototype%"]=qi}var Gi=function t(e){var r;if(e==="%AsyncFunction%")r=Ht("async function () {}");else if(e==="%GeneratorFunction%")r=Ht("function* () {}");else if(e==="%AsyncGeneratorFunction%")r=Ht("async function* () {}");else if(e==="%AsyncGenerator%"){var n=t("%AsyncGeneratorFunction%");n&&(r=n.prototype)}else if(e==="%AsyncIteratorPrototype%"){var a=t("%AsyncGenerator%");a&&(r=U(a.prototype))}return pe[e]=r,r},en={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},ut=Cr,At=Li,Wi=ut.call(Function.call,Array.prototype.concat),Ki=ut.call(Function.apply,Array.prototype.splice),tn=ut.call(Function.call,String.prototype.replace),Et=ut.call(Function.call,String.prototype.slice),Hi=ut.call(Function.call,RegExp.prototype.exec),Vi=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,Ji=/\\(\\)?/g,Qi=function(e){var r=Et(e,0,1),n=Et(e,-1);if(r==="%"&&n!=="%")throw new Me("invalid intrinsic syntax, expected closing `%`");if(n==="%"&&r!=="%")throw new Me("invalid intrinsic syntax, expected opening `%`");var a=[];return tn(e,Vi,function(i,o,s,c){a[a.length]=s?tn(c,Ji,"$1"):o||i}),a},Xi=function(e,r){var n=e,a;if(At(en,n)&&(a=en[n],n="%"+a[0]+"%"),At(pe,n)){var i=pe[n];if(i===Ae&&(i=Gi(n)),typeof i>"u"&&!r)throw new xe("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:a,name:n,value:i}}throw new Me("intrinsic "+e+" does not exist!")},Ar=function(e,r){if(typeof e!="string"||e.length===0)throw new xe("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof r!="boolean")throw new xe('"allowMissing" argument must be a boolean');if(Hi(/^%?[^%]*%?$/,e)===null)throw new Me("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var n=Qi(e),a=n.length>0?n[0]:"",i=Xi("%"+a+"%",r),o=i.name,s=i.value,c=!1,l=i.alias;l&&(a=l[0],Ki(n,Wi([0,1],l)));for(var u=1,d=!0;u<n.length;u+=1){var p=n[u],h=Et(p,0,1),f=Et(p,-1);if((h==='"'||h==="'"||h==="`"||f==='"'||f==="'"||f==="`")&&h!==f)throw new Me("property names with quotes must have matching quotes");if((p==="constructor"||!d)&&(c=!0),a+="."+p,o="%"+a+"%",At(pe,o))s=pe[o];else if(s!=null){if(!(p in s)){if(!r)throw new xe("base intrinsic for "+e+" exists, but the property is not available.");return}if(ue&&u+1>=n.length){var m=ue(s,p);d=!!m,d&&"get"in m&&!("originalValue"in m.get)?s=m.get:s=s[p]}else d=At(s,p),s=s[p];d&&!c&&(pe[o]=s)}}return s},ra={exports:{}};(function(t){var e=Cr,r=Ar,n=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),i=r("%Reflect.apply%",!0)||e.call(a,n),o=r("%Object.getOwnPropertyDescriptor%",!0),s=r("%Object.defineProperty%",!0),c=r("%Math.max%");if(s)try{s({},"a",{value:1})}catch{s=null}t.exports=function(d){var p=i(e,a,arguments);if(o&&s){var h=o(p,"length");h.configurable&&s(p,"length",{value:1+c(0,d.length-(arguments.length-1))})}return p};var l=function(){return i(e,n,arguments)};s?s(t.exports,"apply",{value:l}):t.exports.apply=l})(ra);var Yi=ra.exports,na=Ar,aa=Yi,Zi=aa(na("String.prototype.indexOf")),eo=function(e,r){var n=na(e,!!r);return typeof n=="function"&&Zi(e,".prototype.")>-1?aa(n):n};const to={},ro=Object.freeze(Object.defineProperty({__proto__:null,default:to},Symbol.toStringTag,{value:"Module"})),no=yi(ro);var Er=typeof Map=="function"&&Map.prototype,Jt=Object.getOwnPropertyDescriptor&&Er?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,Pt=Er&&Jt&&typeof Jt.get=="function"?Jt.get:null,rn=Er&&Map.prototype.forEach,Pr=typeof Set=="function"&&Set.prototype,Qt=Object.getOwnPropertyDescriptor&&Pr?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,Ot=Pr&&Qt&&typeof Qt.get=="function"?Qt.get:null,nn=Pr&&Set.prototype.forEach,ao=typeof WeakMap=="function"&&WeakMap.prototype,Je=ao?WeakMap.prototype.has:null,io=typeof WeakSet=="function"&&WeakSet.prototype,Qe=io?WeakSet.prototype.has:null,oo=typeof WeakRef=="function"&&WeakRef.prototype,an=oo?WeakRef.prototype.deref:null,so=Boolean.prototype.valueOf,co=Object.prototype.toString,lo=Function.prototype.toString,uo=String.prototype.match,Or=String.prototype.slice,ne=String.prototype.replace,po=String.prototype.toUpperCase,on=String.prototype.toLowerCase,ia=RegExp.prototype.test,sn=Array.prototype.concat,z=Array.prototype.join,fo=Array.prototype.slice,cn=Math.floor,or=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Xt=Object.getOwnPropertySymbols,sr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,De=typeof Symbol=="function"&&typeof Symbol.iterator=="object",I=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===De||!0)?Symbol.toStringTag:null,oa=Object.prototype.propertyIsEnumerable,ln=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(t){return t.__proto__}:null);function un(t,e){if(t===1/0||t===-1/0||t!==t||t&&t>-1e3&&t<1e3||ia.call(/e/,e))return e;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof t=="number"){var n=t<0?-cn(-t):cn(t);if(n!==t){var a=String(n),i=Or.call(e,a.length+1);return ne.call(a,r,"$&_")+"."+ne.call(ne.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return ne.call(e,r,"$&_")}var cr=no,pn=cr.custom,fn=ca(pn)?pn:null,ho=function t(e,r,n,a){var i=r||{};if(ee(i,"quoteStyle")&&i.quoteStyle!=="single"&&i.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(ee(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var o=ee(i,"customInspect")?i.customInspect:!0;if(typeof o!="boolean"&&o!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(ee(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(ee(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var s=i.numericSeparator;if(typeof e>"u")return"undefined";if(e===null)return"null";if(typeof e=="boolean")return e?"true":"false";if(typeof e=="string")return ua(e,i);if(typeof e=="number"){if(e===0)return 1/0/e>0?"0":"-0";var c=String(e);return s?un(e,c):c}if(typeof e=="bigint"){var l=String(e)+"n";return s?un(e,l):l}var u=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=u&&u>0&&typeof e=="object")return lr(e)?"[Array]":"[Object]";var d=Ro(i,n);if(typeof a>"u")a=[];else if(la(a,e)>=0)return"[Circular]";function p(K,ve,ht){if(ve&&(a=fo.call(a),a.push(ve)),ht){var _e={depth:i.depth};return ee(i,"quoteStyle")&&(_e.quoteStyle=i.quoteStyle),t(K,_e,n+1,a)}return t(K,i,n+1,a)}if(typeof e=="function"&&!dn(e)){var h=Co(e),f=yt(e,p);return"[Function"+(h?": "+h:" (anonymous)")+"]"+(f.length>0?" { "+z.call(f,", ")+" }":"")}if(ca(e)){var m=De?ne.call(String(e),/^(Symbol\(.*\))_[^)]*$/,"$1"):sr.call(e);return typeof e=="object"&&!De?We(m):m}if(Io(e)){for(var b="<"+on.call(String(e.nodeName)),y=e.attributes||[],_=0;_<y.length;_++)b+=" "+y[_].name+"="+sa(yo(y[_].value),"double",i);return b+=">",e.childNodes&&e.childNodes.length&&(b+="..."),b+="</"+on.call(String(e.nodeName))+">",b}if(lr(e)){if(e.length===0)return"[]";var T=yt(e,p);return d&&!xo(T)?"["+ur(T,d)+"]":"[ "+z.call(T,", ")+" ]"}if(mo(e)){var B=yt(e,p);return!("cause"in Error.prototype)&&"cause"in e&&!oa.call(e,"cause")?"{ ["+String(e)+"] "+z.call(sn.call("[cause]: "+p(e.cause),B),", ")+" }":B.length===0?"["+String(e)+"]":"{ ["+String(e)+"] "+z.call(B,", ")+" }"}if(typeof e=="object"&&o){if(fn&&typeof e[fn]=="function"&&cr)return cr(e,{depth:u-n});if(o!=="symbol"&&typeof e.inspect=="function")return e.inspect()}if(Ao(e)){var j=[];return rn&&rn.call(e,function(K,ve){j.push(p(ve,e,!0)+" => "+p(K,e))}),hn("Map",Pt.call(e),j,d)}if(Oo(e)){var dt=[];return nn&&nn.call(e,function(K){dt.push(p(K,e))}),hn("Set",Ot.call(e),dt,d)}if(Eo(e))return Yt("WeakMap");if($o(e))return Yt("WeakSet");if(Po(e))return Yt("WeakRef");if(bo(e))return We(p(Number(e)));if(_o(e))return We(p(or.call(e)));if(vo(e))return We(so.call(e));if(wo(e))return We(p(String(e)));if(!go(e)&&!dn(e)){var oe=yt(e,p),Z=ln?ln(e)===Object.prototype:e instanceof Object||e.constructor===Object,we=e instanceof Object?"":"null prototype",be=!Z&&I&&Object(e)===e&&I in e?Or.call(ie(e),8,-1):we?"Object":"",Ge=Z||typeof e.constructor!="function"?"":e.constructor.name?e.constructor.name+" ":"",F=Ge+(be||we?"["+z.call(sn.call([],be||[],we||[]),": ")+"] ":"");return oe.length===0?F+"{}":d?F+"{"+ur(oe,d)+"}":F+"{ "+z.call(oe,", ")+" }"}return String(e)};function sa(t,e,r){var n=(r.quoteStyle||e)==="double"?'"':"'";return n+t+n}function yo(t){return ne.call(String(t),/"/g,"&quot;")}function lr(t){return ie(t)==="[object Array]"&&(!I||!(typeof t=="object"&&I in t))}function go(t){return ie(t)==="[object Date]"&&(!I||!(typeof t=="object"&&I in t))}function dn(t){return ie(t)==="[object RegExp]"&&(!I||!(typeof t=="object"&&I in t))}function mo(t){return ie(t)==="[object Error]"&&(!I||!(typeof t=="object"&&I in t))}function wo(t){return ie(t)==="[object String]"&&(!I||!(typeof t=="object"&&I in t))}function bo(t){return ie(t)==="[object Number]"&&(!I||!(typeof t=="object"&&I in t))}function vo(t){return ie(t)==="[object Boolean]"&&(!I||!(typeof t=="object"&&I in t))}function ca(t){if(De)return t&&typeof t=="object"&&t instanceof Symbol;if(typeof t=="symbol")return!0;if(!t||typeof t!="object"||!sr)return!1;try{return sr.call(t),!0}catch{}return!1}function _o(t){if(!t||typeof t!="object"||!or)return!1;try{return or.call(t),!0}catch{}return!1}var So=Object.prototype.hasOwnProperty||function(t){return t in this};function ee(t,e){return So.call(t,e)}function ie(t){return co.call(t)}function Co(t){if(t.name)return t.name;var e=uo.call(lo.call(t),/^function\s*([\w$]+)/);return e?e[1]:null}function la(t,e){if(t.indexOf)return t.indexOf(e);for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}function Ao(t){if(!Pt||!t||typeof t!="object")return!1;try{Pt.call(t);try{Ot.call(t)}catch{return!0}return t instanceof Map}catch{}return!1}function Eo(t){if(!Je||!t||typeof t!="object")return!1;try{Je.call(t,Je);try{Qe.call(t,Qe)}catch{return!0}return t instanceof WeakMap}catch{}return!1}function Po(t){if(!an||!t||typeof t!="object")return!1;try{return an.call(t),!0}catch{}return!1}function Oo(t){if(!Ot||!t||typeof t!="object")return!1;try{Ot.call(t);try{Pt.call(t)}catch{return!0}return t instanceof Set}catch{}return!1}function $o(t){if(!Qe||!t||typeof t!="object")return!1;try{Qe.call(t,Qe);try{Je.call(t,Je)}catch{return!0}return t instanceof WeakSet}catch{}return!1}function Io(t){return!t||typeof t!="object"?!1:typeof HTMLElement<"u"&&t instanceof HTMLElement?!0:typeof t.nodeName=="string"&&typeof t.getAttribute=="function"}function ua(t,e){if(t.length>e.maxStringLength){var r=t.length-e.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return ua(Or.call(t,0,e.maxStringLength),e)+n}var a=ne.call(ne.call(t,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,To);return sa(a,"single",e)}function To(t){var e=t.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[e];return r?"\\"+r:"\\x"+(e<16?"0":"")+po.call(e.toString(16))}function We(t){return"Object("+t+")"}function Yt(t){return t+" { ? }"}function hn(t,e,r,n){var a=n?ur(r,n):z.call(r,", ");return t+" ("+e+") {"+a+"}"}function xo(t){for(var e=0;e<t.length;e++)if(la(t[e],`
`)>=0)return!1;return!0}function Ro(t,e){var r;if(t.indent==="	")r="	";else if(typeof t.indent=="number"&&t.indent>0)r=z.call(Array(t.indent+1)," ");else return null;return{base:r,prev:z.call(Array(e+1),r)}}function ur(t,e){if(t.length===0)return"";var r=`
`+e.prev+e.base;return r+z.call(t,","+r)+`
`+e.prev}function yt(t,e){var r=lr(t),n=[];if(r){n.length=t.length;for(var a=0;a<t.length;a++)n[a]=ee(t,a)?e(t[a],t):""}var i=typeof Xt=="function"?Xt(t):[],o;if(De){o={};for(var s=0;s<i.length;s++)o["$"+i[s]]=i[s]}for(var c in t)ee(t,c)&&(r&&String(Number(c))===c&&c<t.length||De&&o["$"+c]instanceof Symbol||(ia.call(/[^\w$]/,c)?n.push(e(c,t)+": "+e(t[c],t)):n.push(c+": "+e(t[c],t))));if(typeof Xt=="function")for(var l=0;l<i.length;l++)oa.call(t,i[l])&&n.push("["+e(i[l])+"]: "+e(t[i[l]],t));return n}var $r=Ar,Le=eo,Mo=ho,Do=$r("%TypeError%"),gt=$r("%WeakMap%",!0),mt=$r("%Map%",!0),ko=Le("WeakMap.prototype.get",!0),Bo=Le("WeakMap.prototype.set",!0),Fo=Le("WeakMap.prototype.has",!0),No=Le("Map.prototype.get",!0),jo=Le("Map.prototype.set",!0),Lo=Le("Map.prototype.has",!0),Ir=function(t,e){for(var r=t,n;(n=r.next)!==null;r=n)if(n.key===e)return r.next=n.next,n.next=t.next,t.next=n,n},Uo=function(t,e){var r=Ir(t,e);return r&&r.value},zo=function(t,e,r){var n=Ir(t,e);n?n.value=r:t.next={key:e,next:t.next,value:r}},qo=function(t,e){return!!Ir(t,e)},Go=function(){var e,r,n,a={assert:function(i){if(!a.has(i))throw new Do("Side channel does not contain "+Mo(i))},get:function(i){if(gt&&i&&(typeof i=="object"||typeof i=="function")){if(e)return ko(e,i)}else if(mt){if(r)return No(r,i)}else if(n)return Uo(n,i)},has:function(i){if(gt&&i&&(typeof i=="object"||typeof i=="function")){if(e)return Fo(e,i)}else if(mt){if(r)return Lo(r,i)}else if(n)return qo(n,i);return!1},set:function(i,o){gt&&i&&(typeof i=="object"||typeof i=="function")?(e||(e=new gt),Bo(e,i,o)):mt?(r||(r=new mt),jo(r,i,o)):(n||(n={key:{},next:null}),zo(n,i,o))}};return a},Wo=String.prototype.replace,Ko=/%20/g,Zt={RFC1738:"RFC1738",RFC3986:"RFC3986"},Tr={default:Zt.RFC3986,formatters:{RFC1738:function(t){return Wo.call(t,Ko,"+")},RFC3986:function(t){return String(t)}},RFC1738:Zt.RFC1738,RFC3986:Zt.RFC3986},Ho=Tr,er=Object.prototype.hasOwnProperty,ce=Array.isArray,L=function(){for(var t=[],e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t}(),Vo=function(e){for(;e.length>1;){var r=e.pop(),n=r.obj[r.prop];if(ce(n)){for(var a=[],i=0;i<n.length;++i)typeof n[i]<"u"&&a.push(n[i]);r.obj[r.prop]=a}}},pa=function(e,r){for(var n=r&&r.plainObjects?Object.create(null):{},a=0;a<e.length;++a)typeof e[a]<"u"&&(n[a]=e[a]);return n},Jo=function t(e,r,n){if(!r)return e;if(typeof r!="object"){if(ce(e))e.push(r);else if(e&&typeof e=="object")(n&&(n.plainObjects||n.allowPrototypes)||!er.call(Object.prototype,r))&&(e[r]=!0);else return[e,r];return e}if(!e||typeof e!="object")return[e].concat(r);var a=e;return ce(e)&&!ce(r)&&(a=pa(e,n)),ce(e)&&ce(r)?(r.forEach(function(i,o){if(er.call(e,o)){var s=e[o];s&&typeof s=="object"&&i&&typeof i=="object"?e[o]=t(s,i,n):e.push(i)}else e[o]=i}),e):Object.keys(r).reduce(function(i,o){var s=r[o];return er.call(i,o)?i[o]=t(i[o],s,n):i[o]=s,i},a)},Qo=function(e,r){return Object.keys(r).reduce(function(n,a){return n[a]=r[a],n},e)},Xo=function(t,e,r){var n=t.replace(/\+/g," ");if(r==="iso-8859-1")return n.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(n)}catch{return n}},Yo=function(e,r,n,a,i){if(e.length===0)return e;var o=e;if(typeof e=="symbol"?o=Symbol.prototype.toString.call(e):typeof e!="string"&&(o=String(e)),n==="iso-8859-1")return escape(o).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});for(var s="",c=0;c<o.length;++c){var l=o.charCodeAt(c);if(l===45||l===46||l===95||l===126||l>=48&&l<=57||l>=65&&l<=90||l>=97&&l<=122||i===Ho.RFC1738&&(l===40||l===41)){s+=o.charAt(c);continue}if(l<128){s=s+L[l];continue}if(l<2048){s=s+(L[192|l>>6]+L[128|l&63]);continue}if(l<55296||l>=57344){s=s+(L[224|l>>12]+L[128|l>>6&63]+L[128|l&63]);continue}c+=1,l=65536+((l&1023)<<10|o.charCodeAt(c)&1023),s+=L[240|l>>18]+L[128|l>>12&63]+L[128|l>>6&63]+L[128|l&63]}return s},Zo=function(e){for(var r=[{obj:{o:e},prop:"o"}],n=[],a=0;a<r.length;++a)for(var i=r[a],o=i.obj[i.prop],s=Object.keys(o),c=0;c<s.length;++c){var l=s[c],u=o[l];typeof u=="object"&&u!==null&&n.indexOf(u)===-1&&(r.push({obj:o,prop:l}),n.push(u))}return Vo(r),e},es=function(e){return Object.prototype.toString.call(e)==="[object RegExp]"},ts=function(e){return!e||typeof e!="object"?!1:!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},rs=function(e,r){return[].concat(e,r)},ns=function(e,r){if(ce(e)){for(var n=[],a=0;a<e.length;a+=1)n.push(r(e[a]));return n}return r(e)},fa={arrayToObject:pa,assign:Qo,combine:rs,compact:Zo,decode:Xo,encode:Yo,isBuffer:ts,isRegExp:es,maybeMap:ns,merge:Jo},da=Go,_t=fa,Xe=Tr,as=Object.prototype.hasOwnProperty,yn={brackets:function(e){return e+"[]"},comma:"comma",indices:function(e,r){return e+"["+r+"]"},repeat:function(e){return e}},H=Array.isArray,is=Array.prototype.push,ha=function(t,e){is.apply(t,H(e)?e:[e])},os=Date.prototype.toISOString,gn=Xe.default,$={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:_t.encode,encodeValuesOnly:!1,format:gn,formatter:Xe.formatters[gn],indices:!1,serializeDate:function(e){return os.call(e)},skipNulls:!1,strictNullHandling:!1},ss=function(e){return typeof e=="string"||typeof e=="number"||typeof e=="boolean"||typeof e=="symbol"||typeof e=="bigint"},tr={},cs=function t(e,r,n,a,i,o,s,c,l,u,d,p,h,f,m,b){for(var y=e,_=b,T=0,B=!1;(_=_.get(tr))!==void 0&&!B;){var j=_.get(e);if(T+=1,typeof j<"u"){if(j===T)throw new RangeError("Cyclic object value");B=!0}typeof _.get(tr)>"u"&&(T=0)}if(typeof c=="function"?y=c(r,y):y instanceof Date?y=d(y):n==="comma"&&H(y)&&(y=_t.maybeMap(y,function(_e){return _e instanceof Date?d(_e):_e})),y===null){if(i)return s&&!f?s(r,$.encoder,m,"key",p):r;y=""}if(ss(y)||_t.isBuffer(y)){if(s){var dt=f?r:s(r,$.encoder,m,"key",p);return[h(dt)+"="+h(s(y,$.encoder,m,"value",p))]}return[h(r)+"="+h(String(y))]}var oe=[];if(typeof y>"u")return oe;var Z;if(n==="comma"&&H(y))f&&s&&(y=_t.maybeMap(y,s)),Z=[{value:y.length>0?y.join(",")||null:void 0}];else if(H(c))Z=c;else{var we=Object.keys(y);Z=l?we.sort(l):we}for(var be=a&&H(y)&&y.length===1?r+"[]":r,Ge=0;Ge<Z.length;++Ge){var F=Z[Ge],K=typeof F=="object"&&typeof F.value<"u"?F.value:y[F];if(!(o&&K===null)){var ve=H(y)?typeof n=="function"?n(be,F):be:be+(u?"."+F:"["+F+"]");b.set(e,T);var ht=da();ht.set(tr,b),ha(oe,t(K,ve,n,a,i,o,n==="comma"&&f&&H(y)?null:s,c,l,u,d,p,h,f,m,ht))}}return oe},ls=function(e){if(!e)return $;if(e.encoder!==null&&typeof e.encoder<"u"&&typeof e.encoder!="function")throw new TypeError("Encoder has to be a function.");var r=e.charset||$.charset;if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var n=Xe.default;if(typeof e.format<"u"){if(!as.call(Xe.formatters,e.format))throw new TypeError("Unknown format option provided.");n=e.format}var a=Xe.formatters[n],i=$.filter;return(typeof e.filter=="function"||H(e.filter))&&(i=e.filter),{addQueryPrefix:typeof e.addQueryPrefix=="boolean"?e.addQueryPrefix:$.addQueryPrefix,allowDots:typeof e.allowDots>"u"?$.allowDots:!!e.allowDots,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:$.charsetSentinel,delimiter:typeof e.delimiter>"u"?$.delimiter:e.delimiter,encode:typeof e.encode=="boolean"?e.encode:$.encode,encoder:typeof e.encoder=="function"?e.encoder:$.encoder,encodeValuesOnly:typeof e.encodeValuesOnly=="boolean"?e.encodeValuesOnly:$.encodeValuesOnly,filter:i,format:n,formatter:a,serializeDate:typeof e.serializeDate=="function"?e.serializeDate:$.serializeDate,skipNulls:typeof e.skipNulls=="boolean"?e.skipNulls:$.skipNulls,sort:typeof e.sort=="function"?e.sort:null,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:$.strictNullHandling}},us=function(t,e){var r=t,n=ls(e),a,i;typeof n.filter=="function"?(i=n.filter,r=i("",r)):H(n.filter)&&(i=n.filter,a=i);var o=[];if(typeof r!="object"||r===null)return"";var s;e&&e.arrayFormat in yn?s=e.arrayFormat:e&&"indices"in e?s=e.indices?"indices":"repeat":s="indices";var c=yn[s];if(e&&"commaRoundTrip"in e&&typeof e.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var l=c==="comma"&&e&&e.commaRoundTrip;a||(a=Object.keys(r)),n.sort&&a.sort(n.sort);for(var u=da(),d=0;d<a.length;++d){var p=a[d];n.skipNulls&&r[p]===null||ha(o,cs(r[p],p,c,l,n.strictNullHandling,n.skipNulls,n.encode?n.encoder:null,n.filter,n.sort,n.allowDots,n.serializeDate,n.format,n.formatter,n.encodeValuesOnly,n.charset,u))}var h=o.join(n.delimiter),f=n.addQueryPrefix===!0?"?":"";return n.charsetSentinel&&(n.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),h.length>0?f+h:""},ke=fa,pr=Object.prototype.hasOwnProperty,ps=Array.isArray,E={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:ke.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},fs=function(t){return t.replace(/&#(\d+);/g,function(e,r){return String.fromCharCode(parseInt(r,10))})},ya=function(t,e){return t&&typeof t=="string"&&e.comma&&t.indexOf(",")>-1?t.split(","):t},ds="utf8=%26%2310003%3B",hs="utf8=%E2%9C%93",ys=function(e,r){var n={},a=r.ignoreQueryPrefix?e.replace(/^\?/,""):e,i=r.parameterLimit===1/0?void 0:r.parameterLimit,o=a.split(r.delimiter,i),s=-1,c,l=r.charset;if(r.charsetSentinel)for(c=0;c<o.length;++c)o[c].indexOf("utf8=")===0&&(o[c]===hs?l="utf-8":o[c]===ds&&(l="iso-8859-1"),s=c,c=o.length);for(c=0;c<o.length;++c)if(c!==s){var u=o[c],d=u.indexOf("]="),p=d===-1?u.indexOf("="):d+1,h,f;p===-1?(h=r.decoder(u,E.decoder,l,"key"),f=r.strictNullHandling?null:""):(h=r.decoder(u.slice(0,p),E.decoder,l,"key"),f=ke.maybeMap(ya(u.slice(p+1),r),function(m){return r.decoder(m,E.decoder,l,"value")})),f&&r.interpretNumericEntities&&l==="iso-8859-1"&&(f=fs(f)),u.indexOf("[]=")>-1&&(f=ps(f)?[f]:f),pr.call(n,h)?n[h]=ke.combine(n[h],f):n[h]=f}return n},gs=function(t,e,r,n){for(var a=n?e:ya(e,r),i=t.length-1;i>=0;--i){var o,s=t[i];if(s==="[]"&&r.parseArrays)o=[].concat(a);else{o=r.plainObjects?Object.create(null):{};var c=s.charAt(0)==="["&&s.charAt(s.length-1)==="]"?s.slice(1,-1):s,l=parseInt(c,10);!r.parseArrays&&c===""?o={0:a}:!isNaN(l)&&s!==c&&String(l)===c&&l>=0&&r.parseArrays&&l<=r.arrayLimit?(o=[],o[l]=a):c!=="__proto__"&&(o[c]=a)}a=o}return a},ms=function(e,r,n,a){if(e){var i=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,o=/(\[[^[\]]*])/,s=/(\[[^[\]]*])/g,c=n.depth>0&&o.exec(i),l=c?i.slice(0,c.index):i,u=[];if(l){if(!n.plainObjects&&pr.call(Object.prototype,l)&&!n.allowPrototypes)return;u.push(l)}for(var d=0;n.depth>0&&(c=s.exec(i))!==null&&d<n.depth;){if(d+=1,!n.plainObjects&&pr.call(Object.prototype,c[1].slice(1,-1))&&!n.allowPrototypes)return;u.push(c[1])}return c&&u.push("["+i.slice(c.index)+"]"),gs(u,r,n,a)}},ws=function(e){if(!e)return E;if(e.decoder!==null&&e.decoder!==void 0&&typeof e.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof e.charset<"u"&&e.charset!=="utf-8"&&e.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var r=typeof e.charset>"u"?E.charset:e.charset;return{allowDots:typeof e.allowDots>"u"?E.allowDots:!!e.allowDots,allowPrototypes:typeof e.allowPrototypes=="boolean"?e.allowPrototypes:E.allowPrototypes,allowSparse:typeof e.allowSparse=="boolean"?e.allowSparse:E.allowSparse,arrayLimit:typeof e.arrayLimit=="number"?e.arrayLimit:E.arrayLimit,charset:r,charsetSentinel:typeof e.charsetSentinel=="boolean"?e.charsetSentinel:E.charsetSentinel,comma:typeof e.comma=="boolean"?e.comma:E.comma,decoder:typeof e.decoder=="function"?e.decoder:E.decoder,delimiter:typeof e.delimiter=="string"||ke.isRegExp(e.delimiter)?e.delimiter:E.delimiter,depth:typeof e.depth=="number"||e.depth===!1?+e.depth:E.depth,ignoreQueryPrefix:e.ignoreQueryPrefix===!0,interpretNumericEntities:typeof e.interpretNumericEntities=="boolean"?e.interpretNumericEntities:E.interpretNumericEntities,parameterLimit:typeof e.parameterLimit=="number"?e.parameterLimit:E.parameterLimit,parseArrays:e.parseArrays!==!1,plainObjects:typeof e.plainObjects=="boolean"?e.plainObjects:E.plainObjects,strictNullHandling:typeof e.strictNullHandling=="boolean"?e.strictNullHandling:E.strictNullHandling}},bs=function(t,e){var r=ws(e);if(t===""||t===null||typeof t>"u")return r.plainObjects?Object.create(null):{};for(var n=typeof t=="string"?ys(t,r):t,a=r.plainObjects?Object.create(null):{},i=Object.keys(n),o=0;o<i.length;++o){var s=i[o],c=ms(s,n[s],r,typeof t=="string");a=ke.merge(a,c,r)}return r.allowSparse===!0?a:ke.compact(a)},vs=us,_s=bs,Ss=Tr,Cs={formats:Ss,parse:_s,stringify:vs},As=function(e){return Es(e)&&!Ps(e)};function Es(t){return!!t&&typeof t=="object"}function Ps(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||Is(t)}var Os=typeof Symbol=="function"&&Symbol.for,$s=Os?Symbol.for("react.element"):60103;function Is(t){return t.$$typeof===$s}function Ts(t){return Array.isArray(t)?[]:{}}function nt(t,e){return e.clone!==!1&&e.isMergeableObject(t)?Be(Ts(t),t,e):t}function xs(t,e,r){return t.concat(e).map(function(n){return nt(n,r)})}function Rs(t,e){if(!e.customMerge)return Be;var r=e.customMerge(t);return typeof r=="function"?r:Be}function Ms(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function mn(t){return Object.keys(t).concat(Ms(t))}function ga(t,e){try{return e in t}catch{return!1}}function Ds(t,e){return ga(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function ks(t,e,r){var n={};return r.isMergeableObject(t)&&mn(t).forEach(function(a){n[a]=nt(t[a],r)}),mn(e).forEach(function(a){Ds(t,a)||(ga(t,a)&&r.isMergeableObject(e[a])?n[a]=Rs(a,r)(t[a],e[a],r):n[a]=nt(e[a],r))}),n}function Be(t,e,r){r=r||{},r.arrayMerge=r.arrayMerge||xs,r.isMergeableObject=r.isMergeableObject||As,r.cloneUnlessOtherwiseSpecified=nt;var n=Array.isArray(e),a=Array.isArray(t),i=n===a;return i?n?r.arrayMerge(t,e,r):ks(t,e,r):nt(e,r)}Be.all=function(e,r){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(n,a){return Be(n,a,r)},{})};var Bs=Be,Fs=Bs;const Ns=gi(Fs);function ma(t){return 65<=t&&t<=90}function wa(t){return 97<=t&&t<=122}function js(t){return 48<=t&&t<=57}function Ls(t){return t-32}function ba(t){return t+32}function xr(t){const e=t.charCodeAt(0);if(js(e)||e===45||isNaN(e))return t;let r=ma(e);const n=r?[ba(e)]:[e],a=t.length;for(let i=1;i<a;i++){let o=t.charCodeAt(i);if(o===95||o===32||o===45){if(r=!0,o=t.charCodeAt(++i),isNaN(o))return t;wa(o)?n.push(Ls(o)):n.push(o)}else n.push(o)}return r?String.fromCharCode.apply(void 0,n):t}function va(t,e){const r=t.charCodeAt(0);if(!wa(r)||isNaN(r))return t;let n=!1;const a=[r];let i=95;e&&e.charCodeAt(0)&&(i=e.charCodeAt(0));const o=t.length;for(let s=1;s<o;s++){const c=t.charCodeAt(s);ma(c)?(n=!0,a.push(i),a.push(ba(c))):a.push(c)}return n?String.fromCharCode.apply(void 0,a):t}function $t(t){return!!t&&typeof t=="object"&&!(t instanceof Function)&&!(t instanceof Date)}function It(t,e,r){if(Array.isArray(t))return function(a,i,o){const s=new Array(a.length);let c=0;for(const l of a)s[c++]=$t(l)?It(l,i,o):l;return s}(t,e,r);if(t.prototype!==void 0)return t;const n={};for(const a in t){const i=t[a];n[e(a,r)]=$t(i)?It(i,e,r):i}return n}function Us(t){return $t(t)?It(t,xr):t}function zs(t,e){return $t(t)?It(t,va,e):t}var wt=typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{},_a=typeof wt=="object"&&wt&&wt.Object===Object&&wt,qs=typeof self=="object"&&self&&self.Object===Object&&self,N=_a||qs||Function("return this")(),D=N.Symbol,Sa=Object.prototype,Gs=Sa.hasOwnProperty,Ws=Sa.toString,Ke=D?D.toStringTag:void 0;function Ks(t){var e=Gs.call(t,Ke),r=t[Ke];try{t[Ke]=void 0;var n=!0}catch{}var a=Ws.call(t);return n&&(e?t[Ke]=r:delete t[Ke]),a}var Hs=Object.prototype,Vs=Hs.toString;function Js(t){return Vs.call(t)}var Qs="[object Null]",Xs="[object Undefined]",wn=D?D.toStringTag:void 0;function Ue(t){return t==null?t===void 0?Xs:Qs:wn&&wn in Object(t)?Ks(t):Js(t)}function V(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Ys="[object AsyncFunction]",Zs="[object Function]",ec="[object GeneratorFunction]",tc="[object Proxy]";function Ca(t){if(!V(t))return!1;var e=Ue(t);return e==Zs||e==ec||e==Ys||e==tc}var rr=N["__core-js_shared__"],bn=function(){var t=/[^.]+$/.exec(rr&&rr.keys&&rr.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function rc(t){return!!bn&&bn in t}var nc=Function.prototype,ac=nc.toString;function he(t){if(t!=null){try{return ac.call(t)}catch{}try{return t+""}catch{}}return""}var ic=/[\\^$.*+?()[\]{}|]/g,oc=/^\[object .+?Constructor\]$/,sc=Function.prototype,cc=Object.prototype,lc=sc.toString,uc=cc.hasOwnProperty,pc=RegExp("^"+lc.call(uc).replace(ic,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function fc(t){if(!V(t)||rc(t))return!1;var e=Ca(t)?pc:oc;return e.test(he(t))}function dc(t,e){return t?.[e]}function ye(t,e){var r=dc(t,e);return fc(r)?r:void 0}var Tt=function(){try{var t=ye(Object,"defineProperty");return t({},"",{}),t}catch{}}();function hc(t,e,r){e=="__proto__"&&Tt?Tt(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function Rr(t,e){return t===e||t!==t&&e!==e}var yc=Object.prototype,gc=yc.hasOwnProperty;function Aa(t,e,r){var n=t[e];(!(gc.call(t,e)&&Rr(n,r))||r===void 0&&!(e in t))&&hc(t,e,r)}var k=Array.isArray;function ae(t){return t!=null&&typeof t=="object"}var mc="[object Symbol]";function kt(t){return typeof t=="symbol"||ae(t)&&Ue(t)==mc}var wc=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,bc=/^\w*$/;function Mr(t,e){if(k(t))return!1;var r=typeof t;return r=="number"||r=="symbol"||r=="boolean"||t==null||kt(t)?!0:bc.test(t)||!wc.test(t)||e!=null&&t in Object(e)}var at=ye(Object,"create");function vc(){this.__data__=at?at(null):{},this.size=0}function _c(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var Sc="__lodash_hash_undefined__",Cc=Object.prototype,Ac=Cc.hasOwnProperty;function Ec(t){var e=this.__data__;if(at){var r=e[t];return r===Sc?void 0:r}return Ac.call(e,t)?e[t]:void 0}var Pc=Object.prototype,Oc=Pc.hasOwnProperty;function $c(t){var e=this.__data__;return at?e[t]!==void 0:Oc.call(e,t)}var Ic="__lodash_hash_undefined__";function Tc(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=at&&e===void 0?Ic:e,this}function fe(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}fe.prototype.clear=vc;fe.prototype.delete=_c;fe.prototype.get=Ec;fe.prototype.has=$c;fe.prototype.set=Tc;function xc(){this.__data__=[],this.size=0}function Bt(t,e){for(var r=t.length;r--;)if(Rr(t[r][0],e))return r;return-1}var Rc=Array.prototype,Mc=Rc.splice;function Dc(t){var e=this.__data__,r=Bt(e,t);if(r<0)return!1;var n=e.length-1;return r==n?e.pop():Mc.call(e,r,1),--this.size,!0}function kc(t){var e=this.__data__,r=Bt(e,t);return r<0?void 0:e[r][1]}function Bc(t){return Bt(this.__data__,t)>-1}function Fc(t,e){var r=this.__data__,n=Bt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function X(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}X.prototype.clear=xc;X.prototype.delete=Dc;X.prototype.get=kc;X.prototype.has=Bc;X.prototype.set=Fc;var it=ye(N,"Map");function Nc(){this.size=0,this.__data__={hash:new fe,map:new(it||X),string:new fe}}function jc(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function Ft(t,e){var r=t.__data__;return jc(e)?r[typeof e=="string"?"string":"hash"]:r.map}function Lc(t){var e=Ft(this,t).delete(t);return this.size-=e?1:0,e}function Uc(t){return Ft(this,t).get(t)}function zc(t){return Ft(this,t).has(t)}function qc(t,e){var r=Ft(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function Y(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}Y.prototype.clear=Nc;Y.prototype.delete=Lc;Y.prototype.get=Uc;Y.prototype.has=zc;Y.prototype.set=qc;var Gc="Expected a function";function Dr(t,e){if(typeof t!="function"||e!=null&&typeof e!="function")throw new TypeError(Gc);var r=function(){var n=arguments,a=e?e.apply(this,n):n[0],i=r.cache;if(i.has(a))return i.get(a);var o=t.apply(this,n);return r.cache=i.set(a,o)||i,o};return r.cache=new(Dr.Cache||Y),r}Dr.Cache=Y;var Wc=500;function Kc(t){var e=Dr(t,function(n){return r.size===Wc&&r.clear(),n}),r=e.cache;return e}var Hc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Vc=/\\(\\)?/g,Jc=Kc(function(t){var e=[];return t.charCodeAt(0)===46&&e.push(""),t.replace(Hc,function(r,n,a,i){e.push(a?i.replace(Vc,"$1"):n||r)}),e});function Qc(t,e){for(var r=-1,n=t==null?0:t.length,a=Array(n);++r<n;)a[r]=e(t[r],r,t);return a}var Xc=1/0,vn=D?D.prototype:void 0,_n=vn?vn.toString:void 0;function Ea(t){if(typeof t=="string")return t;if(k(t))return Qc(t,Ea)+"";if(kt(t))return _n?_n.call(t):"";var e=t+"";return e=="0"&&1/t==-Xc?"-0":e}function xt(t){return t==null?"":Ea(t)}function Nt(t,e){return k(t)?t:Mr(t,e)?[t]:Jc(xt(t))}var Yc=9007199254740991,Zc=/^(?:0|[1-9]\d*)$/;function kr(t,e){var r=typeof t;return e=e??Yc,!!e&&(r=="number"||r!="symbol"&&Zc.test(t))&&t>-1&&t%1==0&&t<e}var el=1/0;function pt(t){if(typeof t=="string"||kt(t))return t;var e=t+"";return e=="0"&&1/t==-el?"-0":e}function Pa(t,e,r,n){if(!V(t))return t;e=Nt(e,t);for(var a=-1,i=e.length,o=i-1,s=t;s!=null&&++a<i;){var c=pt(e[a]),l=r;if(c==="__proto__"||c==="constructor"||c==="prototype")return t;if(a!=o){var u=s[c];l=void 0,l===void 0&&(l=V(u)?u:kr(e[a+1])?[]:{})}Aa(s,c,l),s=s[c]}return t}function Ee(t,e,r){return t==null?t:Pa(t,e,r)}function Br(t,e){e=Nt(e,t);for(var r=0,n=e.length;t!=null&&r<n;)t=t[pt(e[r++])];return r&&r==n?t:void 0}function g(t,e,r){var n=t==null?void 0:Br(t,e);return n===void 0?r:n}var tl="__lodash_hash_undefined__";function rl(t){return this.__data__.set(t,tl),this}function nl(t){return this.__data__.has(t)}function ot(t){var e=-1,r=t==null?0:t.length;for(this.__data__=new Y;++e<r;)this.add(t[e])}ot.prototype.add=ot.prototype.push=rl;ot.prototype.has=nl;function Oa(t,e,r,n){for(var a=t.length,i=r+-1;++i<a;)if(e(t[i],i,t))return i;return-1}function al(t){return t!==t}function il(t,e,r){for(var n=r-1,a=t.length;++n<a;)if(t[n]===e)return n;return-1}function ol(t,e,r){return e===e?il(t,e,r):Oa(t,al,r)}function sl(t,e){var r=t==null?0:t.length;return!!r&&ol(t,e,0)>-1}function $a(t,e){return t.has(e)}var Re=ye(N,"Set");function cl(){}function Fr(t){var e=-1,r=Array(t.size);return t.forEach(function(n){r[++e]=n}),r}var ll=1/0,ul=Re&&1/Fr(new Re([,-0]))[1]==ll?function(t){return new Re(t)}:cl,pl=200;function fl(t,e,r){var n=-1,a=sl,i=t.length,o=!0,s=[],c=s;if(i>=pl){var l=ul(t);if(l)return Fr(l);o=!1,a=$a,c=new ot}else c=s;e:for(;++n<i;){var u=t[n],d=u;if(u=u!==0?u:0,o&&d===d){for(var p=c.length;p--;)if(c[p]===d)continue e;s.push(u)}else a(c,d,r)||(c!==s&&c.push(d),s.push(u))}return s}function Ia(t){return t&&t.length?fl(t):[]}function dl(){this.__data__=new X,this.size=0}function hl(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}function yl(t){return this.__data__.get(t)}function gl(t){return this.__data__.has(t)}var ml=200;function wl(t,e){var r=this.__data__;if(r instanceof X){var n=r.__data__;if(!it||n.length<ml-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new Y(n)}return r.set(t,e),this.size=r.size,this}function G(t){var e=this.__data__=new X(t);this.size=e.size}G.prototype.clear=dl;G.prototype.delete=hl;G.prototype.get=yl;G.prototype.has=gl;G.prototype.set=wl;function bl(t,e){for(var r=-1,n=t==null?0:t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}var vl=1,_l=2;function Ta(t,e,r,n,a,i){var o=r&vl,s=t.length,c=e.length;if(s!=c&&!(o&&c>s))return!1;var l=i.get(t),u=i.get(e);if(l&&u)return l==e&&u==t;var d=-1,p=!0,h=r&_l?new ot:void 0;for(i.set(t,e),i.set(e,t);++d<s;){var f=t[d],m=e[d];if(n)var b=o?n(m,f,d,e,t,i):n(f,m,d,t,e,i);if(b!==void 0){if(b)continue;p=!1;break}if(h){if(!bl(e,function(y,_){if(!$a(h,_)&&(f===y||a(f,y,r,n,i)))return h.push(_)})){p=!1;break}}else if(!(f===m||a(f,m,r,n,i))){p=!1;break}}return i.delete(t),i.delete(e),p}var Rt=N.Uint8Array;function Sl(t){var e=-1,r=Array(t.size);return t.forEach(function(n,a){r[++e]=[a,n]}),r}var Cl=1,Al=2,El="[object Boolean]",Pl="[object Date]",Ol="[object Error]",$l="[object Map]",Il="[object Number]",Tl="[object RegExp]",xl="[object Set]",Rl="[object String]",Ml="[object Symbol]",Dl="[object ArrayBuffer]",kl="[object DataView]",Sn=D?D.prototype:void 0,nr=Sn?Sn.valueOf:void 0;function Bl(t,e,r,n,a,i,o){switch(r){case kl:if(t.byteLength!=e.byteLength||t.byteOffset!=e.byteOffset)return!1;t=t.buffer,e=e.buffer;case Dl:return!(t.byteLength!=e.byteLength||!i(new Rt(t),new Rt(e)));case El:case Pl:case Il:return Rr(+t,+e);case Ol:return t.name==e.name&&t.message==e.message;case Tl:case Rl:return t==e+"";case $l:var s=Sl;case xl:var c=n&Cl;if(s||(s=Fr),t.size!=e.size&&!c)return!1;var l=o.get(t);if(l)return l==e;n|=Al,o.set(t,e);var u=Ta(s(t),s(e),n,a,i,o);return o.delete(t),u;case Ml:if(nr)return nr.call(t)==nr.call(e)}return!1}function xa(t,e){for(var r=-1,n=e.length,a=t.length;++r<n;)t[a+r]=e[r];return t}function Fl(t,e,r){var n=e(t);return k(t)?n:xa(n,r(t))}function Nl(t,e){for(var r=-1,n=t==null?0:t.length,a=0,i=[];++r<n;){var o=t[r];e(o,r,t)&&(i[a++]=o)}return i}function jl(){return[]}var Ll=Object.prototype,Ul=Ll.propertyIsEnumerable,Cn=Object.getOwnPropertySymbols,zl=Cn?function(t){return t==null?[]:(t=Object(t),Nl(Cn(t),function(e){return Ul.call(t,e)}))}:jl;function ql(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Gl="[object Arguments]";function An(t){return ae(t)&&Ue(t)==Gl}var Ra=Object.prototype,Wl=Ra.hasOwnProperty,Kl=Ra.propertyIsEnumerable,jt=An(function(){return arguments}())?An:function(t){return ae(t)&&Wl.call(t,"callee")&&!Kl.call(t,"callee")};function Hl(){return!1}var Ma=typeof R=="object"&&R&&!R.nodeType&&R,En=Ma&&typeof M=="object"&&M&&!M.nodeType&&M,Vl=En&&En.exports===Ma,Pn=Vl?N.Buffer:void 0,Jl=Pn?Pn.isBuffer:void 0,st=Jl||Hl,Ql=9007199254740991;function Nr(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ql}var Xl="[object Arguments]",Yl="[object Array]",Zl="[object Boolean]",eu="[object Date]",tu="[object Error]",ru="[object Function]",nu="[object Map]",au="[object Number]",iu="[object Object]",ou="[object RegExp]",su="[object Set]",cu="[object String]",lu="[object WeakMap]",uu="[object ArrayBuffer]",pu="[object DataView]",fu="[object Float32Array]",du="[object Float64Array]",hu="[object Int8Array]",yu="[object Int16Array]",gu="[object Int32Array]",mu="[object Uint8Array]",wu="[object Uint8ClampedArray]",bu="[object Uint16Array]",vu="[object Uint32Array]",C={};C[fu]=C[du]=C[hu]=C[yu]=C[gu]=C[mu]=C[wu]=C[bu]=C[vu]=!0;C[Xl]=C[Yl]=C[uu]=C[Zl]=C[pu]=C[eu]=C[tu]=C[ru]=C[nu]=C[au]=C[iu]=C[ou]=C[su]=C[cu]=C[lu]=!1;function _u(t){return ae(t)&&Nr(t.length)&&!!C[Ue(t)]}function jr(t){return function(e){return t(e)}}var Da=typeof R=="object"&&R&&!R.nodeType&&R,Ye=Da&&typeof M=="object"&&M&&!M.nodeType&&M,Su=Ye&&Ye.exports===Da,ar=Su&&_a.process,Fe=function(){try{var t=Ye&&Ye.require&&Ye.require("util").types;return t||ar&&ar.binding&&ar.binding("util")}catch{}}(),On=Fe&&Fe.isTypedArray,Lr=On?jr(On):_u,Cu=Object.prototype,Au=Cu.hasOwnProperty;function Eu(t,e){var r=k(t),n=!r&&jt(t),a=!r&&!n&&st(t),i=!r&&!n&&!a&&Lr(t),o=r||n||a||i,s=o?ql(t.length,String):[],c=s.length;for(var l in t)Au.call(t,l)&&!(o&&(l=="length"||a&&(l=="offset"||l=="parent")||i&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||kr(l,c)))&&s.push(l);return s}var Pu=Object.prototype;function Ur(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Pu;return t===r}function ka(t,e){return function(r){return t(e(r))}}var Ou=ka(Object.keys,Object),$u=Object.prototype,Iu=$u.hasOwnProperty;function Ba(t){if(!Ur(t))return Ou(t);var e=[];for(var r in Object(t))Iu.call(t,r)&&r!="constructor"&&e.push(r);return e}function zr(t){return t!=null&&Nr(t.length)&&!Ca(t)}function qr(t){return zr(t)?Eu(t):Ba(t)}function fr(t){return Fl(t,qr,zl)}var Tu=1,xu=Object.prototype,Ru=xu.hasOwnProperty;function Mu(t,e,r,n,a,i){var o=r&Tu,s=fr(t),c=s.length,l=fr(e),u=l.length;if(c!=u&&!o)return!1;for(var d=c;d--;){var p=s[d];if(!(o?p in e:Ru.call(e,p)))return!1}var h=i.get(t),f=i.get(e);if(h&&f)return h==e&&f==t;var m=!0;i.set(t,e),i.set(e,t);for(var b=o;++d<c;){p=s[d];var y=t[p],_=e[p];if(n)var T=o?n(_,y,p,e,t,i):n(y,_,p,t,e,i);if(!(T===void 0?y===_||a(y,_,r,n,i):T)){m=!1;break}b||(b=p=="constructor")}if(m&&!b){var B=t.constructor,j=e.constructor;B!=j&&"constructor"in t&&"constructor"in e&&!(typeof B=="function"&&B instanceof B&&typeof j=="function"&&j instanceof j)&&(m=!1)}return i.delete(t),i.delete(e),m}var dr=ye(N,"DataView"),hr=ye(N,"Promise"),yr=ye(N,"WeakMap"),$n="[object Map]",Du="[object Object]",In="[object Promise]",Tn="[object Set]",xn="[object WeakMap]",Rn="[object DataView]",ku=he(dr),Bu=he(it),Fu=he(hr),Nu=he(Re),ju=he(yr),se=Ue;(dr&&se(new dr(new ArrayBuffer(1)))!=Rn||it&&se(new it)!=$n||hr&&se(hr.resolve())!=In||Re&&se(new Re)!=Tn||yr&&se(new yr)!=xn)&&(se=function(t){var e=Ue(t),r=e==Du?t.constructor:void 0,n=r?he(r):"";if(n)switch(n){case ku:return Rn;case Bu:return $n;case Fu:return In;case Nu:return Tn;case ju:return xn}return e});var Ne=se,Lu=1,Mn="[object Arguments]",Dn="[object Array]",bt="[object Object]",Uu=Object.prototype,kn=Uu.hasOwnProperty;function zu(t,e,r,n,a,i){var o=k(t),s=k(e),c=o?Dn:Ne(t),l=s?Dn:Ne(e);c=c==Mn?bt:c,l=l==Mn?bt:l;var u=c==bt,d=l==bt,p=c==l;if(p&&st(t)){if(!st(e))return!1;o=!0,u=!1}if(p&&!u)return i||(i=new G),o||Lr(t)?Ta(t,e,r,n,a,i):Bl(t,e,c,r,n,a,i);if(!(r&Lu)){var h=u&&kn.call(t,"__wrapped__"),f=d&&kn.call(e,"__wrapped__");if(h||f){var m=h?t.value():t,b=f?e.value():e;return i||(i=new G),a(m,b,r,n,i)}}return p?(i||(i=new G),Mu(t,e,r,n,a,i)):!1}function Lt(t,e,r,n,a){return t===e?!0:t==null||e==null||!ae(t)&&!ae(e)?t!==t&&e!==e:zu(t,e,r,n,Lt,a)}var qu=1,Gu=2;function Wu(t,e,r,n){var a=r.length,i=a;if(t==null)return!i;for(t=Object(t);a--;){var o=r[a];if(o[2]?o[1]!==t[o[0]]:!(o[0]in t))return!1}for(;++a<i;){o=r[a];var s=o[0],c=t[s],l=o[1];if(o[2]){if(c===void 0&&!(s in t))return!1}else{var u=new G,d;if(!(d===void 0?Lt(l,c,qu|Gu,n,u):d))return!1}}return!0}function Fa(t){return t===t&&!V(t)}function Ku(t){for(var e=qr(t),r=e.length;r--;){var n=e[r],a=t[n];e[r]=[n,a,Fa(a)]}return e}function Na(t,e){return function(r){return r==null?!1:r[t]===e&&(e!==void 0||t in Object(r))}}function Hu(t){var e=Ku(t);return e.length==1&&e[0][2]?Na(e[0][0],e[0][1]):function(r){return r===t||Wu(r,t,e)}}function Vu(t,e){return t!=null&&e in Object(t)}function Ju(t,e,r){e=Nt(e,t);for(var n=-1,a=e.length,i=!1;++n<a;){var o=pt(e[n]);if(!(i=t!=null&&r(t,o)))break;t=t[o]}return i||++n!=a?i:(a=t==null?0:t.length,!!a&&Nr(a)&&kr(o,a)&&(k(t)||jt(t)))}function ja(t,e){return t!=null&&Ju(t,e,Vu)}var Qu=1,Xu=2;function Yu(t,e){return Mr(t)&&Fa(e)?Na(pt(t),e):function(r){var n=g(r,t);return n===void 0&&n===e?ja(r,t):Lt(e,n,Qu|Xu)}}function La(t){return t}function Zu(t){return function(e){return e?.[t]}}function ep(t){return function(e){return Br(e,t)}}function tp(t){return Mr(t)?Zu(pt(t)):ep(t)}function Ua(t){return typeof t=="function"?t:t==null?La:typeof t=="object"?k(t)?Yu(t[0],t[1]):Hu(t):tp(t)}function rp(t){return function(e,r,n){var a=Object(e);if(!zr(e)){var i=Ua(r);e=qr(e),r=function(s){return i(a[s],s,a)}}var o=t(e,r,n);return o>-1?a[i?e[o]:o]:void 0}}var np=/\s/;function ap(t){for(var e=t.length;e--&&np.test(t.charAt(e)););return e}var ip=/^\s+/;function op(t){return t&&t.slice(0,ap(t)+1).replace(ip,"")}var Bn=NaN,sp=/^[-+]0x[0-9a-f]+$/i,cp=/^0b[01]+$/i,lp=/^0o[0-7]+$/i,up=parseInt;function q(t){if(typeof t=="number")return t;if(kt(t))return Bn;if(V(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=V(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=op(t);var r=cp.test(t);return r||lp.test(t)?up(t.slice(2),r?2:8):sp.test(t)?Bn:+t}var Fn=1/0,pp=17976931348623157e292;function fp(t){if(!t)return t===0?t:0;if(t=q(t),t===Fn||t===-Fn){var e=t<0?-1:1;return e*pp}return t===t?t:0}function za(t){var e=fp(t),r=e%1;return e===e?r?e-r:e:0}var dp=Math.max;function qa(t,e,r){var n=t==null?0:t.length;if(!n)return-1;var a=r==null?0:za(r);return a<0&&(a=dp(n+a,0)),Oa(t,Ua(e),a)}var J=rp(qa),hp=N.isFinite,yp=Math.min;function gp(t){var e=Math[t];return function(r,n){if(r=q(r),n=n==null?0:yp(za(n),292),n&&hp(r)){var a=(xt(r)+"e").split("e"),i=e(a[0]+"e"+(+a[1]+n));return a=(xt(i)+"e").split("e"),+(a[0]+"e"+(+a[1]-n))}return e(r)}}var Ga=gp("round");function mp(t,e,r){for(var n=-1,a=e.length,i={};++n<a;){var o=e[n],s=Br(t,o);r(s,o)&&Pa(i,Nt(o,t),s)}return i}function wp(t,e){return mp(t,e,function(r,n){return ja(t,n)})}var Nn=D?D.isConcatSpreadable:void 0;function bp(t){return k(t)||jt(t)||!!(Nn&&t&&t[Nn])}function vp(t,e,r,n,a){var i=-1,o=t.length;for(r||(r=bp),a||(a=[]);++i<o;){var s=t[i];r(s)?xa(a,s):a[a.length]=s}return a}function _p(t){var e=t==null?0:t.length;return e?vp(t):[]}function Sp(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var jn=Math.max;function Cp(t,e,r){return e=jn(e===void 0?t.length-1:e,0),function(){for(var n=arguments,a=-1,i=jn(n.length-e,0),o=Array(i);++a<i;)o[a]=n[e+a];a=-1;for(var s=Array(e+1);++a<e;)s[a]=n[a];return s[e]=r(o),Sp(t,this,s)}}function Ap(t){return function(){return t}}var Ep=Tt?function(t,e){return Tt(t,"toString",{configurable:!0,enumerable:!1,value:Ap(e),writable:!0})}:La,Pp=800,Op=16,$p=Date.now;function Ip(t){var e=0,r=0;return function(){var n=$p(),a=Op-(n-r);if(r=n,a>0){if(++e>=Pp)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var Tp=Ip(Ep);function xp(t){return Tp(Cp(t,void 0,_p),t+"")}var Wa=xp(function(t,e){return t==null?{}:wp(t,e)});function Rp(t,e){for(var r=-1,n=t==null?0:t.length;++r<n&&e(t[r],r,t)!==!1;);return t}var Ka=typeof R=="object"&&R&&!R.nodeType&&R,Ln=Ka&&typeof M=="object"&&M&&!M.nodeType&&M,Mp=Ln&&Ln.exports===Ka,Un=Mp?N.Buffer:void 0;Un&&Un.allocUnsafe;function Dp(t,e){return t.slice()}var kp=ka(Object.getPrototypeOf,Object),Bp=Object.prototype,Fp=Bp.hasOwnProperty;function Np(t){var e=t.length,r=new t.constructor(e);return e&&typeof t[0]=="string"&&Fp.call(t,"index")&&(r.index=t.index,r.input=t.input),r}function Gr(t){var e=new t.constructor(t.byteLength);return new Rt(e).set(new Rt(t)),e}function jp(t,e){var r=Gr(t.buffer);return new t.constructor(r,t.byteOffset,t.byteLength)}var Lp=/\w*$/;function Up(t){var e=new t.constructor(t.source,Lp.exec(t));return e.lastIndex=t.lastIndex,e}var zn=D?D.prototype:void 0,qn=zn?zn.valueOf:void 0;function zp(t){return qn?Object(qn.call(t)):{}}function qp(t,e){var r=Gr(t.buffer);return new t.constructor(r,t.byteOffset,t.length)}var Gp="[object Boolean]",Wp="[object Date]",Kp="[object Map]",Hp="[object Number]",Vp="[object RegExp]",Jp="[object Set]",Qp="[object String]",Xp="[object Symbol]",Yp="[object ArrayBuffer]",Zp="[object DataView]",ef="[object Float32Array]",tf="[object Float64Array]",rf="[object Int8Array]",nf="[object Int16Array]",af="[object Int32Array]",of="[object Uint8Array]",sf="[object Uint8ClampedArray]",cf="[object Uint16Array]",lf="[object Uint32Array]";function uf(t,e,r){var n=t.constructor;switch(e){case Yp:return Gr(t);case Gp:case Wp:return new n(+t);case Zp:return jp(t);case ef:case tf:case rf:case nf:case af:case of:case sf:case cf:case lf:return qp(t);case Kp:return new n;case Hp:case Qp:return new n(t);case Vp:return Up(t);case Jp:return new n;case Xp:return zp(t)}}var Gn=Object.create,pf=function(){function t(){}return function(e){if(!V(e))return{};if(Gn)return Gn(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function ff(t){return typeof t.constructor=="function"&&!Ur(t)?pf(kp(t)):{}}var df="[object Map]";function hf(t){return ae(t)&&Ne(t)==df}var Wn=Fe&&Fe.isMap,yf=Wn?jr(Wn):hf,gf="[object Set]";function mf(t){return ae(t)&&Ne(t)==gf}var Kn=Fe&&Fe.isSet,wf=Kn?jr(Kn):mf,Ha="[object Arguments]",bf="[object Array]",vf="[object Boolean]",_f="[object Date]",Sf="[object Error]",Va="[object Function]",Cf="[object GeneratorFunction]",Af="[object Map]",Ef="[object Number]",Ja="[object Object]",Pf="[object RegExp]",Of="[object Set]",$f="[object String]",If="[object Symbol]",Tf="[object WeakMap]",xf="[object ArrayBuffer]",Rf="[object DataView]",Mf="[object Float32Array]",Df="[object Float64Array]",kf="[object Int8Array]",Bf="[object Int16Array]",Ff="[object Int32Array]",Nf="[object Uint8Array]",jf="[object Uint8ClampedArray]",Lf="[object Uint16Array]",Uf="[object Uint32Array]",S={};S[Ha]=S[bf]=S[xf]=S[Rf]=S[vf]=S[_f]=S[Mf]=S[Df]=S[kf]=S[Bf]=S[Ff]=S[Af]=S[Ef]=S[Ja]=S[Pf]=S[Of]=S[$f]=S[If]=S[Nf]=S[jf]=S[Lf]=S[Uf]=!0;S[Sf]=S[Va]=S[Tf]=!1;function St(t,e,r,n,a,i){var o;if(o!==void 0)return o;if(!V(t))return t;var s=k(t);if(s)o=Np(t);else{var c=Ne(t),l=c==Va||c==Cf;if(st(t))return Dp(t);if(c==Ja||c==Ha||l&&!a)o=l?{}:ff(t);else{if(!S[c])return a?t:{};o=uf(t,c)}}i||(i=new G);var u=i.get(t);if(u)return u;i.set(t,o),wf(t)?t.forEach(function(h){o.add(St(h,e,r,h,t,i))}):yf(t)&&t.forEach(function(h,f){o.set(f,St(h,e,r,f,t,i))});var d=fr,p=s?void 0:d(t);return Rp(p||t,function(h,f){p&&(f=h,h=t[f]),Aa(o,f,St(h,e,r,f,t,i))}),o}var zf=1,qf=4;function Ut(t){return St(t,zf|qf)}function zt(t){return xt(t).toLowerCase()}function Qa(t,e){return Lt(t,e)}var Gf="[object Map]",Wf="[object Set]",Kf=Object.prototype,Hf=Kf.hasOwnProperty;function Wr(t){if(t==null)return!0;if(zr(t)&&(k(t)||typeof t=="string"||typeof t.splice=="function"||st(t)||Lr(t)||jt(t)))return!t.length;var e=Ne(t);if(e==Gf||e==Wf)return!t.size;if(Ur(t))return!Ba(t).length;for(var r in t)if(Hf.call(t,r))return!1;return!0}const vt={};let Ze={};function ct(t,e,r={}){if(!e||typeof e!="object"||!t||typeof t!="object")return t;function n(a,i,o){const s=a.slice();return i.forEach((c,l)=>{typeof s[l]>"u"?s[l]=o.cloneUnlessOtherwiseSpecified(c,o):o.isMergeableObject(c)?s[l]=ct(a[l],c,o):a.indexOf(c)===-1&&s.push(c)}),s}return Ns(t,e,{arrayMerge:n})}function Xa(t){Ze=t}function Ya(){return Ze}function lt(t){return t&&typeof t=="object"&&!(t instanceof Array)}function Za(t){return xr(t)}function ei(t){return va(t,"_")}function ze(t){if(!t)return t;const e=JSON.parse(JSON.stringify(t));return Us(e)}function ti(t){return typeof t=="string"?t.split(".").map(xr).join("."):t}function ge(t){if(!t)return t;const e=JSON.parse(JSON.stringify(t));return zs(e,"_")}function ri(t){return qt(je(t))}function qt(t){return typeof t=="string"?t.replace(/^[/]+/,""):""}function je(t){return typeof t=="string"?t.replace(/[/]+$/,""):""}function ni(t){return Cs.stringify(t)}function Kr(t,e){return t instanceof Array?t.map(e):[]}function de(t,e,r){return t instanceof Array?t.reduce(e,r):r}function Hr(){return!(typeof window<"u"&&window&&window.document)}function et(t){return typeof t=="function"}function qe(t,e,r){return{list:r.indexOf("list")>=0?function(n){return t("get",e,void 0,n)}:void 0,get:r.indexOf("get")>=0?function(n,a){return t("get",e,n,a)}:void 0}}async function Gt(t,e,r,n=void 0){const a=Ze.vaultUrl,i=Ze.timeout,s=`swell_vault_response_${Vf()}`;return r={$jsonp:{method:t,callback:s},$data:r,$key:Ze.key},new Promise((c,l)=>{const u=document.createElement("script");u.type="text/javascript",u.src=`${je(a)}/${qt(e)}?${Jf(r)}`;const d=setTimeout(()=>{window[s]({$error:`Request timed out after ${i/1e3} seconds`,$status:500})},i);window[s]=p=>{if(clearTimeout(d),p&&p.$error){const h=new Error(p.$error);h.code="request_error",h.status=p.$status,l(h)}else if(!p||p.$status>=300){const h=new Error("A connection error occurred while making the request");h.code="connection_error",h.status=p.$status,l(h)}else c(p.$data);delete window[s],u.parentNode.removeChild(u)},document.getElementsByTagName("head")[0].appendChild(u)})}function Vf(){return window.__swell_vault_request_id=window.__swell_vault_request_id||0,window.__swell_vault_request_id++,window.__swell_vault_request_id}function Jf(t){const e=[],r=function(n,a){typeof a=="function"?a=a():a==null&&(a=""),e[e.length]=encodeURIComponent(n)+"="+encodeURIComponent(a)};for(const n in t)gr(n,t[n],r);return e.join("&").replace(" ","+")}const Qf=/\[\]$/;function gr(t,e,r){let n;if(e instanceof Array)for(let a=0;a<e.length;a++)Qf.test(t)?r(t,v):gr(t+"["+(typeof v=="object"&&v!=null?a:"")+"]",v,r);else if(e&&typeof e=="object")for(n in e)gr(t+"["+n+"]",e[n],r);else r(t,e)}function ai(t){return typeof btoa<"u"?btoa(t):Buffer.from(t).toString("base64")}function ii(t){const r=t.search.substr(1),n={};return r.split("&").forEach(function(a){const i=a.split("=");n[i[0]]=decodeURIComponent(i[1])}),n}function oi(){const t=window.location.origin+window.location.pathname;window.history.pushState({path:t},"",t)}async function W(t,e,r={}){return vt[t]=vt[t]||new Promise(n=>{const a=document.createElement("script");a.id=t,a.src=e,a.async=!0,a.type="text/javascript";for(const[i,o]of Object.entries(r))a.setAttribute(i,o);a.addEventListener("load",()=>{n(),vt[t]=null},{once:!0}),document.head.appendChild(a)}),vt[t]}function Vr(t){return t!=="test"}var Xf=Object.freeze({__proto__:null,defaultMethods:qe,set:Ee,get:g,uniq:Ia,find:J,round:Ga,pick:Wa,findIndex:qa,camelCase:Za,cloneDeep:Ut,merge:ct,setOptions:Xa,getOptions:Ya,toCamel:ze,toCamelPath:ti,toSnake:ge,trimBoth:ri,trimStart:qt,trimEnd:je,stringifyQuery:ni,isServer:Hr,isFunction:et,isObject:lt,toNumber:q,toLower:zt,isEqual:Qa,isEmpty:Wr,snakeCase:ei,map:Kr,reduce:de,base64Encode:ai,vaultRequest:Gt,getLocationParams:ii,removeUrlParams:oi,loadScript:W,isLiveMode:Vr});const Yf={async createToken(t){let e=null,r=null,n=null;t||(e="Card details are missing in `swell.card.createToken(card)`",n="");const a=ge(t);if(!a.nonce){if(this.validateNumber(a.number)||(e="Card number appears to be invalid",r="invalid_card_number",n="number"),a.exp){const o=this.expiry(a.exp);a.exp_month=o.month,a.exp_year=o.year}this.validateExpiry(a.exp_month,a.exp_year)||(e="Card expiry appears to be invalid",r="invalid_card_expiry",n="exp_month"),this.validateCVC(a.cvc)||(e="Card CVC code appears to be invalid",r="invalid_card_cvc",n="exp_cvc")}if(e){const o=new Error(e);throw o.code=r||"invalid_card",o.status=402,o.param=n,o}const i=await Gt("post","/tokens",a);if(i.errors){const o=Object.keys(i.errors)[0],s=new Error(i.errors[o].message||"Unknown error");throw s.code="vault_error",s.status=402,s.param=o,s}return i},expiry(t){if(t&&t.month&&t.year)return t;const e=new String(t).split(/[\s\/\-]+/,2),r=e[0];let n=e[1];return n&&n.length===2&&/^\d+$/.test(n)&&(n=new Date().getFullYear().toString().substring(0,2)+n),{month:~~r,year:~~n}},types(){let t,e,r,n;for(e={},t=r=40;r<=49;t=++r)e[t]="Visa";for(t=n=50;n<=59;t=++n)e[t]="MasterCard";return e[34]=e[37]="American Express",e[60]=e[62]=e[64]=e[65]="Discover",e[35]="JCB",e[30]=e[36]=e[38]=e[39]="Diners Club",e},type(t){return this.types()[t.slice(0,2)]||"Unknown"},luhnCheck(t){let e,r,n,a,i,o;for(n=!0,a=0,r=(t+"").split("").reverse(),i=0,o=r.length;i<o;i++)e=r[i],e=parseInt(e,10),(n=!n)&&(e*=2),e>9&&(e-=9),a+=e;return a%10===0},validateNumber(t){return t=(t+"").replace(/\s+|-/g,""),t.length>=10&&t.length<=16&&this.luhnCheck(t)},validateExpiry(t,e){let r,n;return t=String(t).trim(),e=String(e).trim(),/^\d+$/.test(t)&&/^\d+$/.test(e)&&parseInt(t,10)<=12?(n=new Date(e,t),r=new Date,n.setMonth(n.getMonth()-1),n.setMonth(n.getMonth()+1,1),n>r):!1},validateCVC(t){return t=String(t).trim(),/^\d+$/.test(t)&&t.length>=3&&t.length<=4}},Zf=604800;function tt(t){if(Hr())return;const e=document.cookie.match(new RegExp("(?:^|; )"+t.replace(/([.$?*|{}()[]\\\/\+^])/g,"\\$1")+"=([^;]*)"));return e?decodeURIComponent(e[1]):void 0}function Jr(t,e,r={}){if(Hr())return;r={path:"/","max-age":Zf,samesite:"lax",...r},r.expires&&r.expires.toUTCString&&(r.expires=r.expires.toUTCString());let n=encodeURIComponent(t)+"="+encodeURIComponent(e);for(const a in r){n+="; "+a;const i=r[a];i!==!0&&(n+="="+i)}document.cookie=n}const ed=5e3;let Ce={};const me={options:{enabled:!0,debug:!1},debug(...t){this.options.debug&&console.log(...t)},values({model:t,id:e},r=void 0){if(this.debug("cache.values",...arguments),r!==void 0){for(let n in r)Ee(Ce,`${t}.${e}.${n}`,r[n]);return}return g(Ce,`${t}.${e}`,{})},preset(t){this.debug("cache.preset",...arguments);const{presets:e=[]}=this.values(t);e.push(t),this.values(t,{presets:e})},set(t){this.debug("cache.set",...arguments);let{model:e,id:r,path:n,value:a}=t,{data:i={},record:o,presets:s}=this.values(t);if(r===null)return;if(o===void 0)return this.preset(t);i=ct(o||{},i);const{useCamelCase:c}=Ya();if(c&&a&&typeof a=="object"&&(a=ze(a)),n||a instanceof Array){let l={...i||{}},u=c?ti(n):n;Ee(l,u||"",a),i=l}else a&&typeof a=="object"?(i=i||{},i=ct(i,a)):i=a;this.values(t,{data:i});try{const l=Ce[e][r];l!==void 0&&(l.data!==void 0&&(l.data=JSON.parse(JSON.stringify(l.data))),l.record!==void 0&&(l.record=JSON.parse(JSON.stringify(l.record))))}catch{}},get(t,e){this.debug("cache.get",...arguments);const{data:r,recordTimer:n}=this.values({model:t,id:e});if(this.debug("cache.get:data+recordTimer",...arguments),n)return r},setRecord(t,e){this.debug("cache.setRecord",...arguments);let{recordTimer:r,presets:n}=this.values(e);if(r&&clearTimeout(r),r=setTimeout(()=>{this.values(e,{record:void 0,recordTimer:void 0})},ed),this.values(e,{record:t!==void 0?t:null,recordTimer:r}),n){for(let i of n)this.set(i);this.values(e,{presets:void 0})}const a=this.get(e.model,e.id);return a!==void 0?a:t},async getFetch(t,e,r){if(this.options.enabled){this.debug("cache.getFetch",...arguments);const a=this.get(t,e);if(a!==void 0)return a}const n=await r();return this.setRecord(n,{model:t,id:e})},clear(t=void 0,e=void 0){this.debug("cache.clear",...arguments),t?e?Ee(Ce,`${t}.${e}`,void 0):Ee(Ce,t,void 0):Ce={}}};function si(t){const{get:e,list:r}=qe(t,"/attributes",["list","get"]);return{get:(n,...a)=>me.getFetch("attributes",n,()=>e(n,...a)),list:r}}let mr;function td(t,e){mr=e;const{get:r,list:n}=qe(t,"/products",["list","get"]);return{get:(a,...i)=>me.getFetch("products",a,()=>r(a,...i)),list:n,variation:ad,categories:li,attributes:ui,priceRange:pi,filters:ci,filterableAttributeFilters:(a,i)=>id(t,a,i)}}function rd(t,e=void 0){if(!t.options)return{};const r=e?t.options.filter(e):t.options;return de(r,(n,a)=>{const i=de(a.values,(o,s)=>({...o,[s.id]:{...s,id:s.id},[s.name]:{...s,id:s.id}}),{});return{...n,[a.id]:{...a,values:i},[a.name]:{...a,values:i}}},{})}function Mt(t){let e=t||[];if(t&&typeof t=="object"&&!(t instanceof Array)){e=[];for(const r in t)e.push({id:r,value:t[r]})}return e instanceof Array?e.map(r=>({id:r.id||r.name,value:r.value})):e}function nd(t,e){if(e.length>0){const r=t.variants&&t.variants.results;if(r.length>0)for(const n of r){const a=ge(n);if(Qa(a.option_value_ids.sort(),e.sort()))return n}}return null}function ad(t,e,r){const n=mr.useCamelCase?ge(t):t,a=Hn(n,r),i={...n,price:typeof a.price!="number"?null:a.price,sale_price:a.sale_price,orig_price:a.orig_price,stock_status:n.stock_status};let o=0;const s=[],c=Mt(e),l=rd(n);for(const u of c)l[u.id]&&l[u.id].values[u.value]&&(l[u.id].variant?s.push(l[u.id].values[u.value].id):o+=l[u.id].values[u.value].price||0);if(s.length>0){const u=nd(n,s);if(u){let d=a;try{d=Hn(u,r)}catch{}i.variant_id=u.id,i.price=d.price||0,i.sale_price=d.sale_price||a.sale_price,i.orig_price=d.orig_price||a.orig_price,i.stock_status=u.stock_status,i.stock_level=u.stock_level||0,i.images=(u.images&&u.images.length?u.images:n.images)||[]}}return o>0&&(i.price+=o,i.sale_price&&(i.sale_price+=o),i.orig_price&&(i.orig_price+=o)),i.sale_price===void 0&&delete i.sale_price,i.orig_price===void 0&&delete i.orig_price,mr.useCamelCase?ze(i):i}function Hn(t,e){const r=g(e,"plan_id",g(e,"plan")),n=g(e,"type",typeof e=="string"?e:r!==void 0?"subscription":"standard");let a=g(t,`purchase_options.${n}`);if(!a&&n!=="standard")throw new Error(`Product purchase option '${n}' not found or not active`);if(a){if(a.plans)if(r!==void 0){if(a=J(a.plans,{id:r}),!a)throw new Error(`Subscription purchase plan '${r}' not found or not active`)}else a=a.plans[0];return{...a,price:typeof a.price=="number"?a.price:t.price,sale_price:typeof a.sale_price=="number"?a.sale_price:t.sale_price,orig_price:typeof a.orig_price=="number"?a.orig_price:t.orig_price}}return{type:"standard",price:t.price,sale_price:t.sale_price,orig_price:t.orig_price}}async function id(t,e,r){const{results:n}=await si(t).list({filterable:!0});return ci(e,{...r,filterableAttributes:n})}function ci(t,e={}){let r=(e.attributes||e.attributes===void 0)&&ui(t);e.filterableAttributes&&(r=r.filter(o=>e.filterableAttributes.find(s=>o.id===s.id)));const n=(e.categories||e.categories===void 0)&&li(t),a=(e.price||e.price===void 0)&&pi(t);let i=[];return a&&i.push({id:"price",label:"Price",type:"range",options:[{value:a.min,label:a.min},{value:a.max,label:a.max}],interval:a.interval}),n&&n.length>0&&i.push({id:"category",label:"Category",type:"select",options:n.map(o=>({value:o.slug,label:o.name}))}),r&&r.length>0&&(i=[...i,...de(r,(o,s)=>[...o,...s.id!=="category"&&s.id!=="price"&&s.values instanceof Array&&s.values.length>0?[{id:s.id,label:s.name,type:"select",options:s.values.map(c=>({value:c,label:c}))}]:[]],[])]),i}function li(t){const e=[],r=t&&t.results||(t.id?[t]:t);if(r instanceof Array){for(let n of r)if(n.categories)for(let a of n.categories){if(!a)continue;J(e,{id:a.id})||e.push(a)}}return e}function ui(t){const e=[],r=t&&t.results||(t.id?[t]:t);if(r instanceof Array){for(let n of r)if(n.attributes)for(let a in n.attributes){if(!n.attributes[a])continue;const i=n.attributes[a].value;let o=J(e,{id:ei(a)});o?o.values=Ia([...o.values,...i instanceof Array?i:[i]]):e.push({...n.attributes[a],value:void 0,values:[...i instanceof Array?i:[i]]})}}return e}function pi(t){let e,r,n;const a=t&&t.results||(t.id?[t]:t);if(a instanceof Array)for(let i of a)(r===void 0||i.price>r)&&(r=Math.ceil(i.price)),(e===void 0||i.price<e)&&(e=Math.floor(i.price));if(e===r)return null;for(n=Math.ceil((r-e)/10)||1,n>1e3?n=1e3:n>100?n=100:n>10&&(n=10),r%n>0&&(r=n+r-r%n),e%n>0&&(e=e-e%n);(r-e)/n%1>0;)r++;return{min:e,max:r,interval:n}}function wr(t,e){return{state:null,order:null,settings:null,requested:!1,pendingRequests:[],cacheClear:null,async requestStateChange(r,n,a,i){return this.requestStateSync(async()=>{const o=await t(r,n,a,i);return o&&o.errors||(this.state=o),o})},async requestStateSync(r){if(this.state)return await r();if(this.requested)return new Promise(a=>{this.pendingRequests.push({handler:r,resolve:a})});this.requested=!0;const n=await r();for(this.requested=!1;this.pendingRequests.length>0;){const{handler:a,resolve:i}=this.pendingRequests.shift();i(a())}return n},get(){if(e.getCart)return e.getCart();let r;return this.cacheClear&&(this.cacheClear=null,r={$cache:!1}),this.requestStateChange("get","/cart",void 0,r)},clearCache(){this.cacheClear=!0},getItemData(r,n={}){let a=Ut(r);return typeof r=="string"&&(a={...n||{},product_id:r}),a&&a.options&&(a.options=Mt(a.options)),a},addItem(r,n){return this.requestStateChange("post","/cart/items",this.getItemData(r,n))},updateItem(r,n){return this.requestStateChange("put",`/cart/items/${r}`,this.getItemData(n))},setItems(r){let n=r;return n&&n.map&&(n=n.map(this.getItemData)),this.requestStateChange("put","/cart/items",n)},removeItem(r){return this.requestStateChange("delete",`/cart/items/${r}`)},recover(r){return this.requestStateChange("put",`/cart/recover/${r}`)},update(r){let n=r;return n.items&&n.items.map&&(n={...n,items:n.items.map(this.getItemData)}),e.updateCart?e.updateCart(r):this.requestStateChange("put","/cart",n)},applyCoupon(r){return this.requestStateChange("put","/cart/coupon",{code:r})},removeCoupon(){return this.requestStateChange("delete","/cart/coupon")},applyGiftcard(r){return this.requestStateChange("post","/cart/giftcards",{code:r})},removeGiftcard(r){return this.requestStateChange("delete",`/cart/giftcards/${r}`)},async getShippingRates(){return await this.requestStateChange("get","/cart/shipment-rating"),this.state[e.useCamelCase?"shipmentRating":"shipment_rating"]},async submitOrder(){const r=await t("post","/cart/order");return r.errors||(this.state=null,this.order=r),r},async getOrder(r=void 0){let n;return r?n=await t("get","/cart/order",{checkout_id:r}):n=await t("get","/cart/order"),this.order=n,n},async getSettings(){return this.settings=await t("get","/cart/settings"),this.settings}}}function od(t){return{state:null,async requestStateChange(e,r,n,a){const i=await t(e,r,n,a);return i&&i.errors?i:this.state=i},get(e){return this.requestStateChange("get","/account",e)},create(e){return this.requestStateChange("post","/account",e)},update(e){return this.requestStateChange("put","/account",e)},login(e,r){return r&&r.password_token?this.requestStateChange("post","/account/login",{email:e,password_token:r.password_token}):this.requestStateChange("post","/account/login",{email:e,password:r})},logout(){return this.state=null,t("post","/account/logout")},recover(e){return t("post","/account/recover",e)},listAddresses(e){return t("get","/account/addresses",e)},createAddress(e){return t("post","/account/addresses",e)},updateAddress(e,r){return t("put",`/account/addresses/${e}`,r)},deleteAddress(e){return t("delete",`/account/addresses/${e}`)},listCards(e){return t("get","/account/cards",e)},createCard(e){return t("post","/account/cards",e)},updateCard(e,r){return t("put",`/account/cards/${e}`,r)},deleteCard(e){return t("delete",`/account/cards/${e}`)},listOrders(e){return t("get","/account/orders",e)},getOrder(e){return t("get",`/account/orders/${e}`)},getAddresses(e){return t("get","/account/addresses",e)},getCards(e){return t("get","/account/cards",e)},getOrders(e){return t("get","/account/orders",e)}}}function sd(t){const{get:e,list:r}=qe(t,"/categories",["list","get"]);return{get:(n,...a)=>me.getFetch("categories",n,()=>e(n,...a)),list:r}}function cd(t){const{get:e,list:r}=qe(t,"/subscriptions",["list","get"]);return{get:(n,...a)=>me.getFetch("subscriptions",n,()=>e(n,...a)),list:r,getCleanData(n){return n&&n.options&&(n.options=Mt(n.options)),n.items&&n.items.map&&(n.items=n.items.map(a=>(a.options&&(a.options=Mt(a.options)),a))),n},create(n){return t("post","/subscriptions",this.getCleanData(n))},update(n,a){return t("put",`/subscriptions/${n}`,this.getCleanData(a))},addItem(n,a){return t("post",`/subscriptions/${n}/items`,this.getCleanData(a))},setItems(n,a){return a&&a.map&&(a=a.map(this.getCleanData)),t("put",`/subscriptions/${n}/items`,a)},updateItem(n,a,i){return t("put",`/subscriptions/${n}/items/${a}`,this.getCleanData(i))},removeItem(n,a){return t("delete",`/subscriptions/${n}/items/${a}`)}}}function ld(t,e){return{get:(r,n,a)=>me.getFetch(`content_${r}`,n,()=>t("get",`/content/${r}`,n,{$preview:e.previewContent,...a||{}})),list:(r,n)=>t("get",`/content/${r}`,void 0,n)}}function Qr(t,e){return{state:null,menuState:null,paymentState:null,subscriptionState:null,sessionState:null,localizedState:{},refresh(){return this.state=null,this.menuState=null,this.paymentState=null,this.subscriptionState=null,this.sessionState=null,this.localizedState={},this.get()},getState(r,n,{id:a=void 0,def:i=void 0,refresh:o=!1}={}){return(!this[n]||o)&&(this[n]=t("get",r)),this[n]&&typeof this[n].then=="function"?this[n].then(s=>(this[n]=s,this.getLocalizedState(n,a,i))):this.getLocalizedState(n,a,i)},getLocalizedState(r,n,a){const i=this.getCurrentLocale(),o=this.localizedState;return o.code!==i&&(o.code=i,delete o[i]),o[i]||(o[i]={}),o[i][r]||(o[i][r]=this.decodeLocale(this[r])),n?g(o[i][r],n,a):o[i][r]},findState(r,n,{where:a=void 0,def:i=void 0}={}){const o=this.getState(r,n);return o&&typeof o.then=="function"?o.then(s=>J(s,a)||i):J(o,a)||i},get(r=void 0,n=void 0){return this.getState("/settings","state",{id:r,def:n})},getCurrentLocale(){return e.api.locale.selected()},getStoreLocale(){return g(this.state,"store.locale")},getStoreLocales(){return g(this.state,"store.locales")},set({model:r,path:n,value:a}){const i=this.getCurrentLocale(),o=r?`${r.replace(/s$/,"")}State`:"state",{useCamelCase:s}=e;let c={};n?Ee(c,n,a):c=a,s&&(c=ze(c)),this[o]=ct(this[o]||{},c),this.localizedState[i]&&(this.localizedState[i][o]=this.decodeLocale(this[o]))},menus(r=void 0,n=void 0){return this.findState("/settings/menus","menuState",{where:{id:r},def:n})},payments(r=void 0,n=void 0){return this.getState("/settings/payments","paymentState",{id:r,def:n})},subscriptions(r=void 0,n=void 0){return this.getState("/settings/subscriptions","subscriptionState",{id:r,def:n})},session(r=void 0,n=void 0){return this.getState("/session","sessionState",{id:r,def:n})},decodeLocale(r){const n=this.getCurrentLocale();if(!r||typeof r!="object")return r;let a=this.getStoreLocales();return a?a=a.reduce((i,o)=>({...i,[o.code]:o}),{}):a={},br(Ut(r),n,a,e)},async load(){try{const{settings:r,menus:n,payments:a,subscriptions:i,session:o}=await t("get","/settings/all");this.localizedState={},this.set({value:r}),this.set({model:"menus",value:n}),this.set({model:"payments",value:a}),this.set({model:"subscriptions",value:i}),this.set({model:"session",value:o})}catch(r){console.error(`Swell: unable to loading settings (${r})`)}}}}function br(t,e,r,n){if(lt(t)){const i=Object.keys(t);for(let o of i)o==="$locale"&&(ud(e,t,o,r,n),delete t.$locale),t[o]!==void 0&&(t[o]=br(t[o],e,r,n))}else if(t instanceof Array)for(var a=0;a<t.length;a++)t[a]=br(t[a],e,r,n);return t}function ud(t,e,r,n,a){if(!t||!lt(e[r]))return;let i,o;const s=Object.keys(e[r]);for(let p of s){const h=p.replace(/\-.+$/,""),f=a.useCamelCase?Za(t):t;(p===t||p===f||h===f)&&(i=t,o=n[t])}if(!i&&lt(n)){const p=Object.keys(n);for(let h of p){const f=h.replace(/\-.+$/,"");(h===t||f===t)&&(i=h,o=n[h])}}let c,l={};if(o){let p=o.fallback;const h=p;for(;p&&(c=c||[],c.push(p),l={...e[r][p]||{},...l},p=n[p]&&n[p].fallback,h!==p););}let u={...l,...e[r][i]||{}};const d=Object.keys(u);for(let p of d){const h=u[p]!==null&&u[p]!=="";let f=c&&!h;if(f)for(let m of c)if(f=!e[r][m]||e[r][m][p]===null||e[r][m][p]==="",f){if(m==="none"){e[p]=null;break}continue}else{e[p]=e[r][m][p];break}else h&&(e[p]=u[p])}}const pd={"stripe-js":fd,"paypal-sdk":dd,"google-pay":hd,"braintree-web":yd,"braintree-paypal-sdk":gd,"braintree-web-paypal-checkout":md,"braintree-google-payment":wd,"braintree-apple-payment":bd,"amazon-checkout":vd};async function fd(){(!window.Stripe||window.Stripe.version!==3)&&await W("stripe-js","https://js.stripe.com/v3/"),window.Stripe||console.error("Warning: Stripe was not loaded"),window.Stripe.StripeV3&&(window.Stripe=window.Stripe.StripeV3),window.Stripe.version!==3&&console.error("Warning: Stripe V3 was not loaded")}async function dd(t){window.paypal||await W("paypal-sdk",`https://www.paypal.com/sdk/js?currency=${t.currency}&client-id=${t.client_id}&merchant-id=${t.merchant_id}&intent=authorize&commit=false`,{"data-partner-attribution-id":"SwellCommerce_SP"}),window.paypal||console.error("Warning: PayPal was not loaded")}async function hd(){window.google||await W("google-pay","https://pay.google.com/gp/p/js/pay.js"),window.google||console.error("Warning: Google was not loaded")}async function yd(){window.braintree||await W("braintree-web","https://js.braintreegateway.com/web/3.73.1/js/client.min.js"),window.braintree||console.error("Warning: Braintree was not loaded")}async function gd(t){window.paypal||await W("braintree-paypal-sdk",`https://www.paypal.com/sdk/js?client-id=${t.client_id}&merchant-id=${t.merchant_id}&vault=true`),window.paypal||console.error("Warning: Braintree PayPal was not loaded")}async function md(){window.braintree&&!window.braintree.paypalCheckout&&await W("braintree-web-paypal-checkout","https://js.braintreegateway.com/web/3.73.1/js/paypal-checkout.min.js"),window.braintree&&!window.braintree.paypalCheckout&&console.error("Warning: Braintree PayPal Checkout was not loaded")}async function wd(){window.braintree&&!window.braintree.googlePayment&&await W("braintree-google-payment","https://js.braintreegateway.com/web/3.73.1/js/google-payment.min.js"),window.braintree&&!window.braintree.googlePayment&&console.error("Warning: Braintree Google Payment was not loaded")}async function bd(){window.braintree&&!window.braintree.applePay&&await W("braintree-apple-payment","https://js.braintreegateway.com/web/3.73.1/js/apple-pay.min.js"),window.braintree&&!window.braintree.applePay&&console.error("Warning: Braintree Apple Payment was not loaded")}async function vd(){window.amazon||await W("amazon-checkout","https://static-na.payments-amazon.com/checkout.js"),window.amazon||console.error("Warning: Amazon Checkout was not loaded")}async function _d(t){if(t){for(const e of t){let r=e,n;lt(e)&&(r=e.id,n=e.params);const a=pd[r];if(!et(a)){console.error(`Unknown script ID: ${r}`);continue}await a(n)}await new Promise(e=>setTimeout(e,1e3))}}class x{constructor(e,r,n,a){this.request=e,this.options=r,this.params=n,this.method=a}async loadScripts(e){await this._populateScriptsParams(e),await _d(e)}async getCart(){const e=await wr(this.request,this.options).get();if(!e)throw new Error("Cart not found");return this._adjustCart(e)}async updateCart(e){const r=Ut(e);if(e.account){const a=await this.getCart();a.guest&&!g(a,"account.email")||delete r.account}const n=await wr(this.request,this.options).update(r);return this._adjustCart(n)}async getSettings(){return Qr(this.request,this.options).get()}async createIntent(e){return this._vaultRequest("post","/intent",e)}async updateIntent(e){return this._vaultRequest("put","/intent",e)}async authorizeGateway(e){return this._vaultRequest("post","/authorization",e)}onSuccess(e){const r=g(this.params,"onSuccess");if(et(r))return r(e)}onCancel(){const e=g(this.params,"onCancel");if(et(e))return e()}onError(e){const r=g(this.params,"onError");if(et(r))return r(e);console.error(e.message)}async _adjustCart(e){return this._ensureCartSettings(e).then(ge)}async _ensureCartSettings(e){if(e.settings)return e;const r=await this.getSettings();return{...e,settings:{...r.store}}}async _vaultRequest(e,r,n){const a=await Gt(e,r,n);if(a.errors){const i=Object.keys(a.errors)[0],o=new Error(a.errors[i].message||"Unknown error");throw o.code="vault_error",o.status=402,o.param=i,o}return a}async _populateScriptsParams(e=[]){for(const r of e)await this._populateScriptWithCartParams(r)}async _populateScriptWithCartParams(e){const r=g(e,"params.cart");if(!r)return;const n=await this.getCart();e.params={...e.params,...Wa(n,r)},delete e.params.cart}}const Sd={USD:.5,AED:2,AUD:.5,BGN:1,BRL:.5,CAD:.5,CHF:.5,CZK:15,DKK:2.5,EUR:.5,GBP:.3,HKD:4,HRK:.5,HUF:175,INR:.5,JPY:50,MXN:10,MYR:2,NOK:3,NZD:.5,PLN:2,RON:2,SEK:3,SGD:.5,THB:10},Dt={city:"city",country:"country",line1:"address1",line2:"address2",postal_code:"zip",state:"state"},Cd={name:"name",phone:"phone"};function Vn(t,e){const r={};for(const[n,a]of Object.entries(t)){const i=e[a];i&&(r[n]=i)}return r}function fi(t){const e={...Vn(Cd,t.billing)};t.account&&t.account.email&&(e.email=t.account.email);const r=Vn(Dt,t.billing);return Wr(r)||(e.address=r),e}function Ad(t){const e=zt(g(t,"currency","eur")),r=Kr(t.items,o=>({type:"sku",description:o.product.name,quantity:o.quantity,currency:e,amount:Math.round(q(o.price_total-o.discount_total)*100)})),n=g(t,"tax_included_total");n&&r.push({type:"tax",description:"Taxes",currency:e,amount:Math.round(q(n)*100)});const a=g(t,"shipping",{}),i=g(t,"shipment_total",{});return a.price&&r.push({type:"shipping",description:a.service_name,currency:e,amount:Math.round(q(i)*100)}),r}function Ed(t,e){const r={shipping_first_name:"first_name",shipping_last_name:"last_name"},n={phone:"phone"},a={first_name:"first_name",last_name:"last_name"},i={email:"email"},o=(d,p)=>de(d,(h,f,m)=>{const b=p[f];return b&&(h[m]=b),h},{});t.klarna={...t.klarna,...o(r,e.shipping)};const s=o(n,e.shipping),c=o(Dt,e.shipping);(s||c)&&(t.source_order.shipping={...s||{},...c?{address:c}:{}}),t.klarna={...t.klarna,...o(a,e.billing||g(e,"account.billing")||e.shipping)};const l=o(i,e.account),u=o(Dt,e.billing||g(e,"account.billing")||e.shipping);(l||u)&&(t.owner={...l||{},...u?{address:u}:{}})}function Pd(t,e){const r=(c,l)=>de(c,(u,d,p)=>{const h=l[d];return h&&(u[p]=h),u},{}),{account:n={},billing:a,shipping:i}=e,o={...n.shipping,...n.billing,...i,...a},s=r(Dt,o);t.owner={email:n.email,name:o.name||n.name,...o.phone?{phone:o.phone}:n.phone?{phone:n.phone}:{},...Wr(s)?{}:{address:s}}}function Ve(t,e,r){const n=r[t]||r,a=n.options||{},i=e.create(t,a);return n.onChange&&i.on("change",n.onChange),n.onReady&&i.on("ready",n.onReady),n.onFocus&&i.on("focus",n.onFocus),n.onBlur&&i.on("blur",n.onBlur),n.onEscape&&i.on("escape",n.onEscape),n.onClick&&i.on("click",n.onClick),i.mount(n.elementId||`#${t}-element`),i}async function Od(t,e,r){const n=fi(r),{paymentMethod:a,error:i}=await t.createPaymentMethod({type:"card",card:e,billing_details:n});return i?{error:i}:{token:a.id,last4:a.card.last4,exp_month:a.card.exp_month,exp_year:a.card.exp_year,brand:a.card.brand,address_check:a.card.checks.address_line1_check,cvc_check:a.card.checks.cvc_check,zip_check:a.card.checks.address_zip_check}}async function $d(t,e,r){const n=fi(r);return await t.createPaymentMethod({type:"ideal",ideal:e,...n?{billing_details:n}:{}})}async function Id(t,e){const r={type:"klarna",flow:"redirect",amount:Math.round(g(e,"grand_total",0)*100),currency:zt(g(e,"currency","eur")),klarna:{product:"payment",purchase_country:g(e,"settings.country","DE")},source_order:{items:Ad(e)},redirect:{return_url:window.location.href}};return Ed(r,e),await t.createSource(r)}async function Td(t,e){const r={type:"bancontact",amount:Math.round(g(e,"grand_total",0)*100),currency:zt(g(e,"currency","eur")),redirect:{return_url:window.location.href}};return Pd(r,e),await t.createSource(r)}function le(t,e){return["BIF","DJF","JPY","KRW","PYG","VND","XAF","XPF","CLP","GNF","KMF","MGA","RWF","VUV","XOF"].includes(t.toUpperCase())?e:Math.round(e*100)}function xd(t,e){const r=Sd[e];return!r||t>=r}class Q extends Error{constructor(e){const r=`${e} payments are disabled. See Payment settings in the Swell dashboard for details`;super(r)}}class Jn extends Error{constructor(e,r){let n=`Unsupported payment method: ${e}`;r&&(n+=` (${r})`),super(n)}}class Wt extends Error{constructor(){super("We are unable to authenticate your payment method. Please choose a different payment method and try again")}}class O extends Error{constructor(e){const r=`${e} was not loaded`;super(r)}}class Qn extends Error{constructor(e,r){const n=`${e} ${r} is missing`;super(n)}}class ft extends Error{constructor(e){const r=`DOM element with '${e}' ID not found`;super(r)}}class te extends x{constructor(e,r,n,a){super(e,r,n,a.card)}get scripts(){return["stripe-js"]}get stripe(){if(!te.stripe&&(window.Stripe&&(this.stripe=window.Stripe(this.method.publishable_key)),!te.stripe))throw new O("Stripe");return te.stripe}set stripe(e){te.stripe=e}get stripeElement(){return te.stripeElement}set stripeElement(e){te.stripeElement=e}async createElements(){const e=this.stripe.elements(this.params.config);this.params.separateElements?(this.stripeElement=Ve("cardNumber",e,this.params),Ve("cardExpiry",e,this.params),Ve("cardCvc",e,this.params)):this.stripeElement=Ve("card",e,this.params)}async tokenize(){if(!this.stripeElement)throw new Error("Stripe payment element is not defined");const e=await this.getCart(),r=await Od(this.stripe,this.stripeElement,e);if(r.error)throw new Error(r.error.message);if(!xd(e.capture_total,e.currency))return await this.updateCart({billing:{method:"card",card:r}}),this.onSuccess();const n=await this._createIntent(e,r);await this.updateCart({billing:{method:"card",card:r,intent:{stripe:{id:n.id,...!!e.auth_total&&{auth_amount:e.auth_total}}}}}),this.onSuccess()}async authenticate(e){const{transaction_id:r,card:{token:n}={}}=e,a=await this.updateIntent({gateway:"stripe",intent:{id:r,payment_method:n}});if(a.error)throw new Error(a.error.message);return this._confirmCardPayment(a)}async _createIntent(e,r){const{account:n,currency:a,capture_total:i,auth_total:o}=e,s=n&&n.stripe_customer,c=(a||"USD").toLowerCase(),l=le(a,i+o),u=await this.createIntent({gateway:"stripe",intent:{amount:l,currency:c,payment_method:r.token,capture_method:"manual",setup_future_usage:"off_session",...s?{customer:s}:{}}});if(!u)throw new Error("Stripe payment intent is not defined");if(!["requires_capture","requires_confirmation"].includes(u.status))throw new Error(`Unsupported intent status: ${u.status}`);return u.status==="requires_confirmation"&&await this._confirmCardPayment(u),u}async _confirmCardPayment(e){const r=await this.stripe.confirmCardPayment(e.client_secret);if(r.error)throw new Error(r.error.message);return{status:r.status}}}class re extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");const i={...a.ideal,publishable_key:a.card.publishable_key};super(e,r,n,i)}get scripts(){return["stripe-js"]}get stripe(){if(!re.stripe&&(window.Stripe&&(this.stripe=window.Stripe(this.method.publishable_key)),!re.stripe))throw new O("Stripe");return re.stripe}set stripe(e){re.stripe=e}get stripeElement(){return re.stripeElement}set stripeElement(e){re.stripeElement=e}async createElements(){const e=this.stripe.elements(this.params.config);this.stripeElement=Ve("idealBank",e,this.params)}async tokenize(){if(!this.stripeElement)throw new Error("Stripe payment element is not defined");const e=await this.getCart(),{paymentMethod:r,error:n}=await $d(this.stripe,this.stripeElement,e);if(n)throw new Error(n.message);const a=await this._createIntent(e,r);await this.stripe.handleCardAction(a.client_secret)}async _createIntent(e,r){const{currency:n,capture_total:a}=e,i=(n||"EUR").toLowerCase(),o=le(n,a),s=await this.createIntent({gateway:"stripe",intent:{amount:o,currency:i,payment_method:r.id,payment_method_types:"ideal",confirmation_method:"manual",confirm:!0,return_url:window.location.href}});if(!s)throw new Error("Stripe payment intent is not defined");if(!["requires_action","requires_source_action"].includes(s.status))throw new Error(`Unsupported intent status (${s.status})`);return await this.updateCart({billing:{method:"ideal",ideal:{token:r.id},intent:{stripe:{id:s.id}}}}),s}}class Pe extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");const i={...a.bancontact,publishable_key:a.card.publishable_key};super(e,r,n,i)}get scripts(){return["stripe-js"]}get stripe(){if(!Pe.stripe&&(window.Stripe&&(this.stripe=window.Stripe(this.method.publishable_key)),!Pe.stripe))throw new O("Stripe");return Pe.stripe}set stripe(e){Pe.stripe=e}async tokenize(){const e=await this.getCart(),{source:r,error:n}=await Td(this.stripe,e);if(n)throw new Error(n.message);await this.updateCart({billing:{method:"bancontact"}}),window.location.replace(r.redirect.url)}}class Oe extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");const i={...a.klarna,publishable_key:a.card.publishable_key};super(e,r,n,i)}get scripts(){return["stripe-js"]}get stripe(){if(!Oe.stripe&&(window.Stripe&&(this.stripe=window.Stripe(this.method.publishable_key)),!Oe.stripe))throw new O("Stripe");return Oe.stripe}set stripe(e){Oe.stripe=e}async tokenize(){const e=await this.getCart(),{source:r,error:n}=await Id(this.stripe,e);if(n)throw new Error(n.message);await this.updateCart({billing:{method:"klarna"}}),window.location.replace(r.redirect.url)}}const Rd="2018-10-31",Xn=2,Yn=0,Md=["PAN_ONLY","CRYPTOGRAM_3DS"],Dd=["AMEX","DISCOVER","INTERAC","JCB","MASTERCARD","VISA"];class $e extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");const i={...a.google,publishable_key:a.card.publishable_key};super(e,r,n,i)}get scripts(){return["google-pay"]}get google(){if(!window.google)throw new O("Google");return window.google}get googleClient(){if(!$e.googleClient&&(this.google&&(this.googleClient=new this.google.payments.api.PaymentsClient({environment:Vr(this.method.mode)?"PRODUCTION":"TEST"})),!$e.googleClient))throw new O("Google client");return $e.googleClient}set googleClient(e){$e.googleClient=e}get tokenizationSpecification(){const e=this.method.publishable_key;if(!e)throw new Error("Stripe publishable key is not defined");return{type:"PAYMENT_GATEWAY",parameters:{gateway:"stripe","stripe:version":Rd,"stripe:publishableKey":e}}}get cardPaymentMethod(){return{type:"CARD",tokenizationSpecification:this.tokenizationSpecification,parameters:{allowedAuthMethods:Md,allowedCardNetworks:Dd,billingAddressRequired:!0,billingAddressParameters:{format:"FULL",phoneNumberRequired:!0}}}}get allowedPaymentMethods(){return[this.cardPaymentMethod]}async createElements(){if(!this.method.merchant_id)throw new Error("Google merchant ID is not defined");if(!(await this.googleClient.isReadyToPay({apiVersion:Xn,apiVersionMinor:Yn,allowedPaymentMethods:this.allowedPaymentMethods,existingPaymentMethodRequired:!0})).result)throw new Error("This device is not capable of making Google Pay payments");const r=await this.getCart(),n=this._createPaymentRequestData(r);this._renderButton(n)}_createPaymentRequestData(e){const{settings:{name:r},capture_total:n,currency:a}=e,{require:{email:i,shipping:o,phone:s}={}}=this.params;return{apiVersion:Xn,apiVersionMinor:Yn,transactionInfo:{currencyCode:a,totalPrice:n.toString(),totalPriceStatus:"ESTIMATED"},allowedPaymentMethods:this.allowedPaymentMethods,emailRequired:!!i,shippingAddressRequired:!!o,shippingAddressParameters:{phoneNumberRequired:!!s},merchantInfo:{merchantName:r,merchantId:this.method.merchant_id}}}_renderButton(e){const{elementId:r="googlepay-button",locale:n="en",style:{color:a="black",type:i="buy",sizeMode:o="fill"}={},classes:s={}}=this.params,c=document.getElementById(r);if(!c)throw new ft(r);s.base&&c.classList.add(s.base);const l=this.googleClient.createButton({buttonColor:a,buttonType:i,buttonSizeMode:o,buttonLocale:n,onClick:this._onClick.bind(this,e)});c.appendChild(l)}async _onClick(e){try{const r=await this.googleClient.loadPaymentData(e);r&&await this._submitPayment(r)}catch(r){this.onError(r)}}async _submitPayment(e){const{require:{shipping:r}={}}=this.params,{email:n,shippingAddress:a,paymentMethodData:i}=e,{info:{billingAddress:o},tokenizationData:s}=i,c=JSON.parse(s.token),{card:l}=c;await this.updateCart({account:{email:n},billing:{method:"card",card:{token:c.id,brand:l.brand,last4:l.last4,exp_month:l.exp_month,exp_year:l.exp_year,gateway:"stripe"},...this._mapAddress(o)},...r&&{shipping:this._mapAddress(a)}}),this.onSuccess()}_mapAddress(e){return{name:e.name,address1:e.address1,address2:e.address2,city:e.locality,state:e.administrativeArea,zip:e.postalCode,country:e.countryCode,phone:e.phoneNumber}}}class Ie extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");const i={...a.apple,publishable_key:a.card.publishable_key};super(e,r,n,i)}get scripts(){return["stripe-js"]}get stripe(){if(!Ie.stripe&&(window.Stripe&&(this.stripe=window.Stripe(this.method.publishable_key)),!Ie.stripe))throw new O("Stripe");return Ie.stripe}set stripe(e){Ie.stripe=e}async createElements(){await this._authorizeDomain();const e=await this.getCart(),r=this._createPaymentRequest(e),n=await r.canMakePayment();if(!n||!n.applePay)throw new Error("This device is not capable of making Apple Pay payments");this._renderButton(r)}async _authorizeDomain(){const e=window.location.hostname;if(!await this.authorizeGateway({gateway:"stripe",params:{applepay_domain:e}}))throw new Error(`${e} domain is not verified`)}_createPaymentRequest(e){const{require:{name:r,email:n,shipping:a,phone:i}={}}=this.params,o=this.stripe.paymentRequest({requestPayerName:!!r,requestPayerEmail:!!n,requestPayerPhone:!!i,requestShipping:!!a,disableWallets:["googlePay","browserCard","link"],...this._getPaymentRequestData(e)});return o.on("shippingaddresschange",this._onShippingAddressChange.bind(this)),o.on("shippingoptionchange",this._onShippingOptionChange.bind(this)),o.on("paymentmethod",this._onPaymentMethod.bind(this)),o}_renderButton(e){const{elementId:r="applepay-button",style:{type:n="default",theme:a="dark",height:i="40px"}={},classes:o={}}=this.params;if(!document.getElementById(r))throw new ft(r);this.stripe.elements().create("paymentRequestButton",{paymentRequest:e,style:{paymentRequestButton:{type:n,theme:a,height:i}},classes:o}).mount(`#${r}`)}_getPaymentRequestData(e){const{currency:r,shipping:n,items:a,capture_total:i,shipment_rating:o,shipment_total:s,tax_included_total:c,settings:l}=e,u=r.toLowerCase(),d=a.map(f=>({label:f.product.name,amount:le(r,f.price_total-f.discount_total)}));c&&d.push({label:"Taxes",amount:le(r,c)}),n.price&&s&&d.push({label:n.service_name,amount:le(r,s)});const p=o&&o.services;let h;return p&&(h=p.map(f=>({id:f.id,label:f.name,detail:f.description,amount:le(r,f.price)}))),{country:l.country,currency:u,total:{label:l.name,amount:le(r,i),pending:!0},displayItems:d,shippingOptions:h}}async _onShippingAddressChange(e){const{shippingAddress:r,updateWith:n}=e,a=this._mapShippingAddress(r),i=await this.updateCart({shipping:{...a,service:null},shipment_rating:null});n(i?{status:"success",...this._getPaymentRequestData(i)}:{status:"invalid_shipping_address"})}async _onShippingOptionChange(e){const{shippingOption:r,updateWith:n}=e,a=await this.updateCart({shipping:{service:r.id}});n(a?{status:"success",...this._getPaymentRequestData(a)}:{status:"fail"})}async _onPaymentMethod(e){const{payerEmail:r,paymentMethod:{id:n,card:a,billing_details:i},shippingAddress:o,shippingOption:s,complete:c}=e,{require:{shipping:l}={}}=this.params;await this.updateCart({account:{email:r},...l&&{shipping:{...this._mapShippingAddress(o),service:s.id}},billing:{...this._mapBillingAddress(i),method:"card",card:{gateway:"stripe",token:n,brand:a.brand,exp_month:a.exp_month,exp_year:a.exp_year,last4:a.last4,address_check:a.checks.address_line1_check,zip_check:a.checks.address_postal_code_check,cvc_check:a.checks.cvc_check}}}),c("success"),this.onSuccess()}_mapShippingAddress(e={}){return{name:e.recipient,address1:e.addressLine[0],address2:e.addressLine[1],city:e.city,state:e.region,zip:e.postalCode,country:e.country,phone:e.phone}}_mapBillingAddress(e={}){return{name:e.name,phone:e.phone,address1:e.address.line1,address2:e.address.line2,city:e.address.city,state:e.address.state,zip:e.address.postal_code,country:e.address.country}}}class kd extends x{constructor(e,r,n,a){super(e,r,n,a.paypal)}get scripts(){const{client_id:e,merchant_id:r}=this.method;return[{id:"braintree-paypal-sdk",params:{client_id:e,merchant_id:r}},"braintree-web","braintree-web-paypal-checkout"]}get paypal(){if(!window.paypal)throw new O("PayPal");return window.paypal}get braintree(){if(!window.braintree)throw new O("Braintree");return window.braintree}get braintreePaypalCheckout(){if(!this.braintree.paypalCheckout)throw new O("Braintree PayPal Checkout");return this.braintree.paypalCheckout}async createElements(){const e=await this.getCart(),r=await this.authorizeGateway({gateway:"braintree"});if(r.error)throw new Error(r.error.message);const n=await this.braintree.client.create({authorization:r}),a=await this.braintreePaypalCheckout.create({client:n});this.paypal.Buttons({style:this.params.style||{},createBillingAgreement:this._onCreateBillingAgreement.bind(this,a,e),onApprove:this._onApprove.bind(this,a),onCancel:this.onCancel.bind(this),onError:this.onError.bind(this)}).render(this.params.elementId||"#paypal-button")}_onCreateBillingAgreement(e,r){return e.createPayment({flow:"vault",currency:r.currency,amount:r.capture_total})}async _onApprove(e,r,n){const{nonce:a}=await e.tokenizePayment(r);await this.updateCart({billing:{method:"paypal",paypal:{nonce:a}}}),this.onSuccess(r,n)}}const ir=2,Zn=0,Bd=["PAN_ONLY","CRYPTOGRAM_3DS"],Fd=["AMEX","DISCOVER","INTERAC","JCB","MASTERCARD","VISA"];class Te extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");super(e,r,n,a.google)}get scripts(){return["google-pay","braintree-web","braintree-google-payment"]}get braintree(){if(!window.braintree)throw new O("Braintree");return window.braintree}get google(){if(!window.google)throw new O("Google");return window.google}get googleClient(){if(!Te.googleClient&&(this.google&&(this.googleClient=new this.google.payments.api.PaymentsClient({environment:Vr(this.method.mode)?"PRODUCTION":"TEST"})),!Te.googleClient))throw new O("Google client");return Te.googleClient}set googleClient(e){Te.googleClient=e}get cardPaymentMethod(){return{type:"CARD",parameters:{allowedAuthMethods:Bd,allowedCardNetworks:Fd,billingAddressRequired:!0,billingAddressParameters:{format:"FULL",phoneNumberRequired:!0}}}}get allowedPaymentMethods(){return[this.cardPaymentMethod]}async createElements(){if(!this.method.merchant_id)throw new Error("Google merchant ID is not defined");if(!(await this.googleClient.isReadyToPay({apiVersion:ir,apiVersionMinor:Zn,allowedPaymentMethods:this.allowedPaymentMethods,existingPaymentMethodRequired:!0})).result)throw new Error("This device is not capable of making Google Pay payments");const r=await this._createBraintreeClient(),n=await this.braintree.googlePayment.create({client:r,googleMerchantId:this.method.merchant_id,googlePayVersion:ir}),a=await this.getCart(),i=this._createPaymentRequestData(a),o=n.createPaymentDataRequest(i);this._renderButton(n,o)}async _createBraintreeClient(){const e=await this.authorizeGateway({gateway:"braintree"});if(e.error)throw new Error(e.error.message);return this.braintree.client.create({authorization:e})}_createPaymentRequestData(e){const{settings:{name:r},capture_total:n,currency:a}=e,{require:{email:i,shipping:o,phone:s}={}}=this.params;return{apiVersion:ir,apiVersionMinor:Zn,transactionInfo:{currencyCode:a,totalPrice:n.toString(),totalPriceStatus:"ESTIMATED"},allowedPaymentMethods:this.allowedPaymentMethods,emailRequired:!!i,shippingAddressRequired:!!o,shippingAddressParameters:{phoneNumberRequired:!!s},merchantInfo:{merchantName:r,merchantId:this.method.merchant_id}}}_renderButton(e,r){const{elementId:n="googlepay-button",locale:a="en",style:{color:i="black",type:o="buy",sizeMode:s="fill"}={},classes:c={}}=this.params,l=document.getElementById(n);if(!l)throw new ft(n);c.base&&l.classList.add(c.base);const u=this.googleClient.createButton({buttonColor:i,buttonType:o,buttonSizeMode:s,buttonLocale:a,onClick:this._onClick.bind(this,e,r)});l.appendChild(u)}async _onClick(e,r){try{const n=await this.googleClient.loadPaymentData(r);n&&await this._submitPayment(e,n)}catch(n){this.onError(n)}}async _submitPayment(e,r){const{require:{shipping:n}={}}=this.params,{nonce:a}=await e.parseResponse(r),{email:i,shippingAddress:o,paymentMethodData:s}=r,{info:{billingAddress:c}}=s;await this.updateCart({account:{email:i},billing:{method:"google",google:{nonce:a,gateway:"braintree"},...this._mapAddress(c)},...n&&{shipping:this._mapAddress(o)}}),this.onSuccess()}_mapAddress(e){return{name:e.name,address1:e.address1,address2:e.address2,city:e.locality,state:e.administrativeArea,zip:e.postalCode,country:e.countryCode,phone:e.phoneNumber}}}const Nd=3,jd=["supports3DS","supportsDebit","supportsCredit"];class Ld extends x{constructor(e,r,n,a){if(!a.card)throw new Q("Credit cards");super(e,r,n,a.apple)}get scripts(){return["braintree-web","braintree-apple-payment"]}get braintree(){if(!window.braintree)throw new O("Braintree");return window.braintree}get ApplePaySession(){if(!window.ApplePaySession)throw new O("Apple");return window.ApplePaySession}async createElements(){if(!this.ApplePaySession.canMakePayments())throw new Error("This device is not capable of making Apple Pay payments");const e=await this.getCart(),r=await this._createBraintreeClient(),n=await this.braintree.applePay.create({client:r}),a=await this._createPaymentRequest(e,n);this._renderButton(n,a)}_renderButton(e,r){const{elementId:n="applepay-button",style:{type:a="plain",theme:i="black",height:o="40px"}={},classes:s={}}=this.params,c=document.getElementById(n);if(!c)throw new ft(n);s.base&&c.classList.add(s.base);const l=document.createElement("div");l.style.appearance="-apple-pay-button",l.style["-apple-pay-button-type"]=a,l.style["-apple-pay-button-style"]=i,l.style.height=o,l.addEventListener("click",this._createPaymentSession.bind(this,e,r)),c.appendChild(l)}async _createBraintreeClient(){const e=await this.authorizeGateway({gateway:"braintree"});if(e.error)throw new Error(e.error.message);return this.braintree.client.create({authorization:e})}_createPaymentRequest(e,r){const{require:n={}}=this.params,{settings:{name:a},capture_total:i,currency:o}=e,s=[],c=["postalAddress"];return n.name&&s.push("name"),n.email&&s.push("email"),n.phone&&s.push("phone"),n.shipping&&s.push("postalAddress"),r.createPaymentRequest({total:{label:a,type:"pending",amount:i.toString()},currencyCode:o,merchantCapabilities:jd,requiredShippingContactFields:s,requiredBillingContactFields:c})}_createPaymentSession(e,r){const n=new this.ApplePaySession(Nd,r);n.onvalidatemerchant=async a=>{const i=await e.performValidation({validationURL:a.validationURL,displayName:r.total.label}).catch(this.onError.bind(this));i?n.completeMerchantValidation(i):n.abort()},n.onpaymentauthorized=async a=>{const{payment:{token:i,shippingContact:o,billingContact:s}}=a,{require:{shipping:c}={}}=this.params,l=await e.tokenize({token:i}).catch(this.onError.bind(this));return l?(await this.updateCart({account:{email:o.emailAddress},billing:{method:"apple",apple:{nonce:l.nonce,gateway:"braintree"},...this._mapAddress(s)},...c&&{shipping:this._mapAddress(o)}}),this.onSuccess(),n.completePayment(this.ApplePaySession.STATUS_SUCCESS)):n.completePayment(this.ApplePaySession.STATUS_FAILURE)},n.begin()}_mapAddress(e={}){return{first_name:e.givenName,last_name:e.familyName,address1:e.addressLines[0],address2:e.addressLines[1],city:e.locality,state:e.administrativeArea,zip:e.postalCode,country:e.countryCode,phone:e.phoneNumber}}}class Ud extends x{constructor(e,r,n,a){super(e,r,n,a.card)}get orderId(){return Math.random().toString(36).substr(2,9)}async tokenize(){const e=await this.getCart(),r=await this.createIntent({gateway:"quickpay",intent:{order_id:this.orderId,currency:e.currency||"USD"}});await this.updateCart({billing:{method:"card",intent:{quickpay:{id:r}}}});const n=window.location.origin+window.location.pathname,a=await this.authorizeGateway({gateway:"quickpay",params:{action:"create",continueurl:`${n}?gateway=quickpay&redirect_status=succeeded`,cancelurl:`${n}?gateway=quickpay&redirect_status=canceled`}});a&&a.url&&window.location.replace(a.url)}async handleRedirect(e){const{redirect_status:r,card_id:n}=e;switch(r){case"succeeded":return this._handleSuccessfulRedirect(n);case"canceled":throw new Wt;default:throw new Error(`Unknown redirect status: ${r}`)}}async _handleSuccessfulRedirect(e){const r=await this.authorizeGateway({gateway:"quickpay",params:{action:"get",id:e}});if(r.error)throw new Error(r.error.message);await this.updateCart({billing:{method:"card",card:r}}),this.onSuccess()}}function zd(t){const r=`${window.location.origin+window.location.pathname}?gateway=paysafecard`;return{type:"PAYSAFECARD",amount:t.capture_total,redirect:{success_url:r,failure_url:r},notification_url:r,customer:{id:g(t,"account.id")},currency:g(t,"currency","USD")}}class qd extends x{constructor(e,r,n,a){super(e,r,n,a.paysafecard)}async tokenize(){const e=await this.getCart(),r=zd(e),n=await this.createIntent({gateway:"paysafecard",intent:r});if(!n)throw new Error("Paysafecard payment is not defined");await this.updateCart({billing:{method:"paysafecard",intent:{paysafecard:{id:n.id}}}}),window.location.replace(n.redirect.auth_url)}async handleRedirect(){const e=await this.getCart(),r=g(e,"billing.intent.paysafecard.id");if(!r)throw new Error("Paysafecard payment ID is not defined");const n=await this.updateIntent({gateway:"paysafecard",intent:{payment_id:r}});if(!n)throw new Error("Paysafecard payment is not defined");switch(n.status){case"SUCCESS":case"AUTHORIZED":return this.onSuccess();case"CANCELED_CUSTOMER":throw new Wt;default:throw new Error(`Unknown redirect status: ${n.status}.`)}}}const Gd={given_name:"first_name",family_name:"last_name",city:"city",country:"country",phone:"phone",postal_code:"zip",street_address:"address1",street_address2:"address2",region:"state"},Wd=(t,e)=>de(t,(r,n,a)=>{const i=e[n];return i&&(r[a]=i),r},{}),ea=(t,e)=>({...Wd(Gd,t[e]),email:g(t,"account.email")});function Kd(t){const e=Kr(t.items,s=>({type:"physical",name:g(s,"product.name"),reference:g(s,"product.sku")||g(s,"product.slug"),quantity:s.quantity,unit_price:Math.round(q(s.price-s.discount_each)*100),total_amount:Math.round(q(s.price_total-s.discount_total)*100),tax_rate:0,total_tax_amount:0})),r=g(t,"tax_included_total"),n=q(r)*100;r&&e.push({type:"sales_tax",name:"Taxes",quantity:1,unit_price:n,total_amount:n,tax_rate:0,total_tax_amount:0});const a=g(t,"shipping",{}),i=g(t,"shipment_total",{}),o=q(i)*100;return a.price&&e.push({type:"shipping_fee",name:a.service_name,quantity:1,unit_price:o,total_amount:o,tax_rate:0,total_tax_amount:0}),e}function Hd(t){const e=`${window.location.origin}${window.location.pathname}?gateway=klarna_direct&sid={{session_id}}`,r=`${e}&authorization_token={{authorization_token}}`;return{locale:t.display_locale||g(t,"settings.locale")||"en-US",purchase_country:g(t,"billing.country")||g(t,"shipping.country"),purchase_currency:t.currency,billing_address:ea(t,"billing"),shipping_address:ea(t,"shipping"),order_amount:Math.round(g(t,"capture_total",0)*100),order_lines:JSON.stringify(Kd(t)),merchant_urls:{success:r,back:e,cancel:e,error:e,failure:e}}}class Vd extends x{constructor(e,r,n,a){super(e,r,n,a.klarna)}async tokenize(){const e=await this.getCart(),r=Hd(e),n=await this.createIntent({gateway:"klarna",intent:r});if(!n)throw new Error("Klarna session is not defined");window.location.replace(n.redirect_url)}async handleRedirect(e){const{authorization_token:r}=e;if(!r)throw new Wt;await this.updateCart({billing:{method:"klarna",klarna:{token:r}}}),this.onSuccess()}}class Jd extends x{constructor(e,r,n,a){super(e,r,n,a.paypal)}get scripts(){const{client_id:e,merchant_id:r}=this.method;return[{id:"paypal-sdk",params:{client_id:e,merchant_id:r,cart:["currency"]}}]}get paypal(){if(!window.paypal)throw new O("PayPal");return window.paypal}async createElements(){const e=await this.getCart(),{locale:r,style:n,elementId:a}=this.params;if(!(e.capture_total>0))throw new Error("Invalid PayPal button amount. Value should be greater than zero.");this.paypal.Buttons({locale:r||"en_US",style:n||{layout:"horizontal",height:45,color:"gold",shape:"rect",label:"paypal",tagline:!1},createOrder:this._onCreateOrder.bind(this,e),onApprove:this._onApprove.bind(this,e),onError:this.onError.bind(this)}).render(a||"#paypal-button")}_onCreateOrder(e,r,n){const{capture_total:a,currency:i}=e;return n.order.create({intent:"AUTHORIZE",purchase_units:[{amount:{value:+a.toFixed(2),currency_code:i}}]})}async _onApprove(e,r,n){const a=await n.order.get(),i=a.id,o=a.payer,s=g(a,"purchase_units[0].shipping");await this.updateCart({account:{email:o.email_address},billing:{method:"paypal",paypal:{order_id:i}},shipping:{name:s.name.full_name,address1:s.address.address_line_1,address2:s.address.address_line_2,state:s.address.admin_area_1,city:s.address.admin_area_2,zip:s.address.postal_code,country:s.address.country_code}}),this.onSuccess()}}class Qd extends x{constructor(e,r,n,a){super(e,r,n,a.amazon)}get scripts(){return["amazon-checkout"]}get amazon(){if(!window.amazon)throw new O("Amazon");return window.amazon}get merchantId(){const e=this.method.merchant_id;if(!e)throw new Qn("Amazon","merchant_id");return e}get publicKeyId(){const e=this.method.public_key_id;if(!e)throw new Qn("Amazon","public_key_id");return e}get returnUrl(){return`${window.location.origin+window.location.pathname}?gateway=amazon`}async createElements(){const e=await this.getCart(),r=this.returnUrl,n=!!e.subscription_delivery,a=await this.authorizeGateway({gateway:"amazon",params:{chargePermissionType:n?"Recurring":"OneTime",...n?{recurringMetadata:{frequency:{unit:"Variable",value:"0"}}}:{},webCheckoutDetails:{checkoutReviewReturnUrl:`${r}&redirect_status=succeeded`,checkoutCancelUrl:`${r}&redirect_status=canceled`}}});this._renderButton(e,a)}async tokenize(){const e=await this.getCart(),r=this.returnUrl,n=g(e,"billing.amazon.checkout_session_id");if(!n)throw new Error("Missing Amazon Pay checkout session ID (billing.amazon.checkout_session_id)");const a=await this.createIntent({gateway:"amazon",intent:{checkoutSessionId:n,webCheckoutDetails:{checkoutResultReturnUrl:`${r}&confirm=true&redirect_status=succeeded`,checkoutCancelUrl:`${r}&redirect_status=canceled`},paymentDetails:e.capture_total>0?{paymentIntent:"Authorize",canHandlePendingAuthorization:!0,chargeAmount:{amount:e.capture_total,currencyCode:e.currency}}:{paymentIntent:"Confirm"}}});return window.location.replace(a.redirect_url)}async handleRedirect(e){const{redirect_status:r}=e;switch(r){case"succeeded":return this._handleSuccessfulRedirect(e);case"canceled":throw new Wt;default:throw new Error(`Unknown redirect status: ${r}`)}}_renderButton(e,r){const n=this.amazon,a=this.merchantId,i=this.publicKeyId,{payload:o,signature:s}=r,{elementId:c="amazonpay-button",locale:l="en_US",placement:u="Checkout",style:{color:d="Gold"}={},require:{shipping:p}={},classes:h={}}=this.params,f=document.getElementById(c);if(!f)throw new ft(c);n.Pay.renderButton(`#${c}`,{ledgerCurrency:e.currency,checkoutLanguage:l,productType:p?"PayAndShip":"PayOnly",buttonColor:d,placement:u,merchantId:a,publicKeyId:i,createCheckoutSessionConfig:{payloadJSON:o,signature:s}}),h.base&&f.classList.add(h.base)}async _handleSuccessfulRedirect(e){const{confirm:r,amazonCheckoutSessionId:n}=e;r||await this.updateCart({billing:{method:"amazon",amazon:{checkout_session_id:n}}}),this.onSuccess()}}class Xd{constructor(e,r){this.request=e,this.options=r}get(e){return this.request("get","/payments",e)}async methods(){return this.methodSettings?this.methodSettings:(this.methodSettings=await this.request("get","/payment/methods"),this.methodSettings)}async createElements(e){if(this.params=e,!e)throw new Error("Payment element parameters are not provided");this._performPaymentAction("createElements")}async tokenize(e=this.params){if(this.params=e,!this.params)throw new Error("Tokenization parameters are not provided");this._performPaymentAction("tokenize")}async handleRedirect(e=this.params){const r=ii(window.location);if(!(!r||!r.gateway)){if(this.params=e,!e)throw new Error("Redirect parameters are not provided");oi(),this._performPaymentAction("handleRedirect",r)}}async authenticate(e){try{const r=await this.get(e);if(!r)throw new Error("Payment not found");const{method:n,gateway:a}=r,i=this._getPaymentClass(n,a);if(!i)throw new Jn(n,a);const o=await this._getPaymentMethods();if(!o[n])throw new Q(n);const c=new i(this.request,this.options,null,o);return await c.loadScripts(c.scripts),await c.authenticate(r)}catch(r){return{error:r}}}async createIntent(e){return this._vaultRequest("post","/intent",e)}async updateIntent(e){return this._vaultRequest("put","/intent",e)}async authorizeGateway(e){return this._vaultRequest("post","/authorization",e)}_normalizeParams(){this.params&&this.params.config&&(console.warn('Please move the "config" field to the payment method parameters ("card.config" or/and "ideal.config").'),this.params.card&&(this.params.card.config=this.params.config),this.params.ideal&&(this.params.ideal.config=this.params.config),delete this.params.config)}async _getPaymentMethods(){const e=await Qr(this.request,this.options).payments();if(e.error)throw new Error(e.error);return ge(e)}async _vaultRequest(e,r,n){const a=await Gt(e,r,n);if(a.errors){const i=Object.keys(a.errors)[0],o=new Error(a.errors[i].message||"Unknown error");throw o.code="vault_error",o.status=402,o.param=i,o}return this.options.useCamelCase?ze(a):a}async _performPaymentAction(e,...r){const n=await this._getPaymentMethods();this._normalizeParams(),Object.entries(this.params).forEach(([a,i])=>{const o=n[a];if(!o)return console.error(new Q(a));const s=this._getPaymentClass(a,o.gateway);if(!s)return console.error(new Jn(a,o.gateway));try{const c=new s(this.request,this.options,i,n);c.loadScripts(c.scripts).then(c[e].bind(c,...r)).catch(c.onError.bind(c))}catch(c){return console.error(c.message)}})}_getPaymentClass(e,r){switch(e){case"card":return this._getCardPaymentClass(r);case"ideal":return this._getIDealPaymentClass(r);case"bancontact":return this._getBancontactPaymentClass(r);case"klarna":return this._getKlarnaPaymentClass(r);case"paysafecard":return this._getPaysafecardPaymentClass(r);case"paypal":return this._getPaypalPaymentClass(r);case"google":return this._getGooglePaymentClass(r);case"apple":return this._getApplePaymentClass(r);case"amazon":return this._getAmazonPaymentClass(r);default:return null}}_getCardPaymentClass(e){switch(e){case"stripe":return te;case"quickpay":return Ud;default:return null}}_getIDealPaymentClass(e){switch(e){case"stripe":return re;default:return null}}_getBancontactPaymentClass(e){switch(e){case"stripe":return Pe;default:return null}}_getKlarnaPaymentClass(e){switch(e){case"stripe":return Oe;case"klarna":return Vd;default:return null}}_getPaysafecardPaymentClass(e){switch(e){default:return qd}}_getPaypalPaymentClass(e){switch(e){case"braintree":return kd;default:return Jd}}_getGooglePaymentClass(e){switch(e){case"stripe":return $e;case"braintree":return Te;default:return null}}_getApplePaymentClass(e){switch(e){case"stripe":return Ie;case"braintree":return Ld;default:return null}}_getAmazonPaymentClass(e){switch(e){default:return Qd}}}function Yd(t,e){return{code:null,state:null,list(){return e.api.settings.get("store.locales",[])},async select(r){return this.set(r),Jr("swell-locale",r),e.api.settings.locale=r,await t("put","/session",{locale:r})},selected(){if(this.code)return this.code;const r=e.api.settings.getStoreLocale(),n=tt("swell-locale");return e.api.settings.locale=n||r,n||r},get(){return this.code||(this.code=this.selected()),this.state||(this.state=this.set(this.code)),this.state},set(r){return this.code=r,this.state=J(this.list(),{code:r})||{},this.state}}}const He={};function Zd(t,e){return{code:null,state:null,locale:null,list(){return e.api.settings.get("store.currencies",[])},async select(r){return this.set(r),t("put","/session",{currency:r})},selected(){return this.code||this.set(tt("swell-currency")||e.api.settings.get("store.currency")),this.code},get(){return this.code||(this.code=this.selected()),this.state||(this.state=this.set(this.code)),this.state},set(r="USD"){return this.code=r,this.state=J(this.list(),{code:r})||{code:r},this.locale=String(e.api.settings.get("store.locale",typeof navigator=="object"?navigator.language:"en-US")),Jr("swell-currency",r),this.state},format(r,n={}){let a=this.get();if(n.code&&n.code!==a.code){const b=this.list();a=J(b,{code:n.code})||{code:n.code}}const{code:i="USD",type:o,decimals:s,rate:c}=a,l=n.code||i,u=n.rate||c,d=n.locale||this.locale,p="decimals"in n?n.decimals:s,{convert:h=!0}=n;let f=r;h&&(o==="display"||n.rate)&&typeof f=="number"&&typeof u=="number"&&(f=this.applyRounding(r*u,a));const m=this.formatter({code:l,locale:d,decimals:p});try{if(typeof f=="number")return m.format(f);{const b=g(m.formatToParts(0),"0.value","$");return b!==l?b:""}}catch(b){console.warn(b)}return String(r)},formatter({code:r,locale:n,decimals:a}){n=String(n||"").replace("_","-");const i=[r,n,a].join("|");if(He[i])return He[i];const o=[];n&&o.push(n),o.push("en-US");const s=typeof a=="number"?a:void 0,c={style:"currency",currency:r,currencyDisplay:"symbol",minimumFractionDigits:s,maximumFractionDigits:s};try{try{He[i]=new Intl.NumberFormat(o,c)}catch(l){l.message.indexOf("Invalid language tag")>=0&&(He[i]=new Intl.NumberFormat("en-US",c))}}catch(l){console.warn(l)}return He[i]},applyRounding(r,n){if(!n||!n.round)return r;const a=n.decimals,i=n.round_interval==="fraction"&&n.round_fraction||0;let o=~~r,s=this.round(r,a);if(s===i)return o+s;const c=this.round(s-i,1);switch(n.round==="nearest"?c>0?c>=.5?"up":"down":c<=-.5?"down":"up":n.round){case"down":o=o+i-(s>i?0:1);break;case"up":default:o=o+i+(s>i?1:0);break}return this.round(o,a)},round:Ga}}function eh(t){const{get:e,list:r}=qe(t,"/invoices",["list","get"]);return{get:(n,...a)=>me.getFetch("invoices",n,()=>e(n,...a)),list:r}}const A={store:null,key:null,url:null,useCamelCase:null,previewContent:null},Xr={version:"3.21.6",options:A,request:P,init(t,e,r={}){A.key=e,A.store=t,A.url=r.url?je(r.url):`https://${t}.swell.store`,A.vaultUrl=r.vaultUrl?je(r.vaultUrl):"https://vault.schema.io",A.timeout=r.timeout&&parseInt(r.timeout,10)||2e4,A.useCamelCase=r.useCamelCase||!1,A.previewContent=r.previewContent||!1,A.session=r.session,A.locale=r.locale,A.currency=r.currency,A.api=Xr,A.getCart=r.getCart,A.updateCart=r.updateCart,Xa(A)},auth(...t){return this.init(...t)},get(t,e){return P("get",t,e)},put(t,e){return P("put",t,e)},post(t,e){return P("post",t,e)},delete(t,e){return P("delete",t,e)},cache:me,card:Yf,cart:wr(P,A),account:od(P),products:td(P,A),categories:sd(P),attributes:si(P),subscriptions:cd(P),invoices:eh(P),content:ld(P,A),settings:Qr(P,A),payment:new Xd(P,A),locale:Yd(P,A),currency:Zd(P,A),utils:Xf};async function P(t,e,r=void 0,n=void 0,a=void 0){const i={...A,...a},o=i.session||tt("swell-session"),s=i.locale||tt("swell-locale"),c=i.currency||tt("swell-currency"),l=`${i.url}${i.base||""}/api`,u=String(t).toLowerCase();let d=e,p=r;(n!==void 0||typeof r=="string")&&(d=[je(e),qt(r)].join("/"),p=n),d=i.fullUrl||`${l}/${ri(d)}`,p=i.useCamelCase?ge(p):p;let h;if(u==="get"){let _;[d,_]=d.split("?");const T=[_,ni(p)].join("&").replace(/^&/,"");d=`${d}${T?`?${T}`:""}`}else h=JSON.stringify(p);const f={Accept:"application/json","Content-Type":"application/json",Authorization:`Basic ${ai(String(i.key))}`};o&&(f["X-Session"]=o),s&&(f["X-Locale"]=s),c&&(f["X-Currency"]=c);const m=await fetch(d,{method:u,headers:f,body:h,credentials:"include",mode:"cors"}),b=m.headers.get("X-Session");typeof b=="string"&&o!==b&&Jr("swell-session",b);const y=await m.json();if(y&&y.error){const _=new Error(y.error.message);throw _.status=m.status,_.code=y.error.code,_.param=y.error.param,_}else if(!m.ok){const _=new Error("A connection error occurred while making the request");throw _.code="connection_error",_}return A.useCamelCase?ze(y):y}let vr="",_r="";const th=document.getElementById("queryInput"),rh=document.getElementById("runQueryBtn"),Ct=document.getElementById("result");document.addEventListener("saveSettings",t=>{vr=t.detail.storeId,_r=t.detail.publicKey,Xr.init(vr,_r),Ct.textContent="Swell initialized successfully"});rh.addEventListener("click",async()=>{if(!vr||!_r){Ct.textContent="Please set Store ID and Public Key in the settings first.";return}try{const t=th.value,r=await new Function("swell",`return ${t}`)(Xr);Ct.textContent=JSON.stringify(r,null,2)}catch(t){Ct.textContent=`Error: ${t.message}`}})});export default nh();
